<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quy đổi điểm tuyển sinh</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #E63946;
            --secondary-color: #C1121F;
            --light-bg: #FFF1F2;
            --success-color: #2A9D8F;
            --danger-color: #E63946;
            --warning-color: #F4A261;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background: url('background.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4); /* Lớp phủ mờ đen 40% */
            z-index: -1;
        }

        /* Header styles đã được di chuyển vào card */

        .card {
            border: none;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(230, 57, 70, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(230, 57, 70, 0.15);
        }

        .form-control, .form-select {
            border-radius: 12px;
            padding: 12px;
            border: 2px solid #FFE4E6;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(230, 57, 70, 0.1);
        }

        .form-label {
            font-weight: 500;
            color: #4B5563;
            margin-bottom: 0.5rem;
        }

        .btn {
            border-radius: 12px;
            padding: 0.8rem 2rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 12px;
            padding: 12px 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 57, 70, 0.3);
        }

        .btn-outline-primary {
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .btn-outline-success {
            border: 2px solid var(--success-color);
            color: var(--success-color);
        }

        .btn-outline-success:hover {
            background: var(--success-color);
            color: white;
            transform: translateY(-2px);
        }

        .result-card {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(230, 57, 70, 0.1);
            margin-top: 2rem;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .loading-state {
            text-align: center;
            padding: 2rem;
        }

        .loading-state p {
            color: var(--primary-color);
            font-weight: 500;
            margin-top: 1rem;
        }

        .share-btn {
            background: linear-gradient(135deg, var(--success-color), #238B7E);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.8rem 2rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 157, 143, 0.3);
            color: white;
        }

        .info-text {
            color: #4B5563;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .table {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(230, 57, 70, 0.05);
        }

        .table thead th {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 1rem;
            font-weight: 500;
        }

        .table td {
            padding: 1rem;
            vertical-align: middle;
            border-bottom: 1px solid #FFE4E6;
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        .table tbody tr:hover {
            background-color: rgba(230, 57, 70, 0.05);
        }

        .alert {
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .alert-danger {
            background-color: #FFF1F2;
            border-color: #FECDD3;
            color: #BE123C;
        }

        .alert i {
            margin-right: 0.5rem;
        }

        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .shape {
            position: absolute;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            opacity: 0.05;
            border-radius: 50%;
        }

        .shape-1 {
            width: 300px;
            height: 300px;
            top: -150px;
            right: -150px;
        }

        .shape-2 {
            width: 200px;
            height: 200px;
            bottom: -100px;
            left: -100px;
        }

        .shape-3 {
            width: 150px;
            height: 150px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* Modern Loading Animation */
        .modern-loader {
            position: relative;
            width: 80px;
            height: 80px;
            margin: 0 auto;
        }

        .modern-loader div {
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--primary-color);
            animation-timing-function: cubic-bezier(0, 1, 1, 0);
        }

        .modern-loader div:nth-child(1) {
            left: 8px;
            animation: modern-loader1 0.6s infinite;
        }

        .modern-loader div:nth-child(2) {
            left: 8px;
            animation: modern-loader2 0.6s infinite;
        }

        .modern-loader div:nth-child(3) {
            left: 32px;
            animation: modern-loader2 0.6s infinite;
        }

        .modern-loader div:nth-child(4) {
            left: 56px;
            animation: modern-loader3 0.6s infinite;
        }

        @keyframes modern-loader1 {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }

        @keyframes modern-loader3 {
            0% { transform: scale(1); }
            100% { transform: scale(0); }
        }

        @keyframes modern-loader2 {
            0% { transform: translate(0, 0); }
            100% { transform: translate(24px, 0); }
        }

        @media (max-width: 768px) {
            .display-5 {
                font-size: 1.8rem !important;
            }

            .lead {
                font-size: 1rem !important;
            }

            .card {
                margin: 0 1rem;
            }

            .btn-primary {
                width: 100%;
            }

            body, .container, .card, .form-label, .form-control, .form-select, .btn, .result-header h4, .result-summary, .benchmark-title, .benchmark-table, .benchmark-table th, .benchmark-table td, .score-status {
                font-size: 13px !important;
            }
            .header h1, .header .display-4 {
                font-size: 1.3rem !important;
            }
            .header p.lead {
                font-size: 1rem !important;
            }
            .form-label {
                font-size: 12px !important;
            }
            .form-control, .form-select {
                font-size: 13px !important;
                padding: 8px 10px;
            }
            .btn, .btn-primary, .btn-outline-primary, .btn-outline-success, .share-btn {
                font-size: 13px !important;
                padding: 0.6rem 1.2rem;
            }
            .result-header {
                padding: 1rem;
            }
            .result-summary {
                padding: 0.7rem;
                margin-bottom: 1rem;
            }
            .benchmark-title {
                font-size: 1rem !important;
                margin-bottom: 0.5rem;
            }
            .benchmark-card {
                padding: 1rem;
            }
            .benchmark-table th, .benchmark-table td {
                font-size: 12px !important;
                padding: 0.4rem 0.2rem;
            }
            .score-status {
                font-size: 12px !important;
                padding: 0.15rem 0.5rem;
            }
            .table-responsive, .benchmark-table {
                margin-bottom: 0.5rem;
            }
            .info-text {
                font-size: 12px !important;
            }
            .card-title, h4, h5 {
                font-size: 1rem !important;
            }
            .result-card {
                padding: 1rem;
            }
            .mt-4, .mb-4 {
                margin-top: 1rem !important;
                margin-bottom: 1rem !important;
            }

            /* Tối ưu bảng ngành cho mobile */
            .benchmark-table th:first-child,
            .benchmark-table td:first-child {
                display: none;
            }
            .benchmark-table th, .benchmark-table td {
                font-size: 13px;
                padding: 0.5rem 0.3rem;
            }
            .benchmark-table {
                font-size: 13px;
            }
            .benchmark-table th, .benchmark-table td {
                white-space: nowrap;
            }
            .benchmark-table {
                overflow-x: auto;
                display: block;
            }
        }

        /* Enhanced Result Display */
        .result-animation {
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-row {
            animation: fadeInRow 0.5s ease-out;
            animation-fill-mode: both;
        }

        @keyframes fadeInRow {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .score-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            animation: pulse 1s ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .method-name {
            font-weight: 500;
            color: #4B5563;
        }

        .result-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem;
            border-radius: 15px 15px 0 0;
            margin-bottom: 1rem;
        }

        .result-header h4 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .result-summary {
            background: #FFF1F2;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .result-summary p {
            margin: 0;
            color: #4B5563;
            font-size: 0.95rem;
        }

        .table tbody tr {
            transition: all 0.3s ease;
        }

        .table tbody tr:hover {
            background-color: rgba(230, 57, 70, 0.05);
            transform: translateX(5px);
        }

        .table tbody tr td {
            transition: all 0.3s ease;
        }

        .table tbody tr:hover td {
            color: var(--primary-color);
        }

        .share-btn {
            position: relative;
            overflow: hidden;
        }

        .share-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .share-btn:hover::after {
            width: 300px;
            height: 300px;
        }

        /* Chart Styles */
        .chart-container {
            position: relative;
            margin: 2rem 0;
            padding: 1rem;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(230, 57, 70, 0.1);
            height: 400px;
        }

        .chart-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
        }

        #scoreChart {
            width: 100% !important;
            height: 100% !important;
        }

        .chart-title {
            color: var(--primary-color);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: center;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #4B5563;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .chart-tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .chart-tab {
            padding: 0.5rem 1rem;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chart-tab.active {
            background: var(--primary-color);
            color: white;
        }

        .chart-tab:hover {
            transform: translateY(-2px);
        }

        /* Benchmark Score Styles */
        .benchmark-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1rem;
            box-shadow: 0 5px 15px rgba(230, 57, 70, 0.1);
        }

        .benchmark-title {
            color: var(--primary-color);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .benchmark-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 1rem;
        }

        .benchmark-table th,
        .benchmark-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #FFE4E6;
        }

        .benchmark-table th {
            background: #FFF1F2;
            font-weight: 600;
            color: #4B5563;
        }

        .benchmark-table tr:hover {
            background-color: rgba(230, 57, 70, 0.05);
        }

        .score-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .score-status.low {
            background-color: #fee2e2;
            color: #b91c1c;
        }

        .score-status.risky {
            background-color: #fef9c3;
            color: #b45309;
        }

        .score-status.safe {
            background-color: #d1fae5;
            color: #047857;
        }

        .score-status.very-safe {
            background-color: #10b981;
            color: #fff;
            font-weight: bold;
        }

        .search-box {
            position: relative;
            margin-bottom: 1rem;
        }

        .search-box input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.5rem;
            border: 2px solid #FFE4E6;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(230, 57, 70, 0.1);
        }

        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #9CA3AF;
        }

        /* Percentile Card Styles */
        .percentile-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .percentile-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 57, 70, 0.1);
        }

        /* New Percentile Range Display */
        .percentile-result-card {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 2px solid #ffc107;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.2);
        }

        .percentile-range {
            margin: 20px 0;
        }

        .percentile-text {
            display: block;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #495057;
        }

        .percentile-numbers {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .percentile-from, .percentile-to {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 3px 10px rgba(40, 167, 69, 0.3);
            min-width: 80px;
        }

        .percentile-separator {
            font-weight: bold;
            color: #6c757d;
            font-size: 1.1em;
        }

        .percentile-description {
            display: block;
            font-size: 1em;
            color: #6c757d;
            margin-top: 10px;
        }

        .percentile-info {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
        }

        .percentile-info li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e9ecef;
        }

        .percentile-info li:last-child {
            border-bottom: none;
        }

        /* Priority Object Modal Styles */
        #viewMorePriority {
            transition: all 0.3s ease;
        }

        #viewMorePriority:hover {
            color: var(--secondary-color) !important;
            transform: translateY(-1px);
        }

        .priority-modal .card-header {
            font-weight: 600;
        }

        .priority-modal .card-body h6 {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .priority-modal .card-body ul {
            padding-left: 1.2rem;
        }

        .priority-modal .card-body li {
            margin-bottom: 0.3rem;
            line-height: 1.5;
        }

        /* Priority Modal Red Theme */
        .priority-modal .priority-header-1 {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .priority-modal .priority-header-2 {
            background: linear-gradient(135deg, #DC3545, #B02A37);
            color: white;
        }

        .priority-modal .priority-text-1 {
            color: var(--primary-color);
        }

        .priority-modal .priority-text-2 {
            color: #DC3545;
        }

        /* Region Modal Styles */
        #viewMoreRegion {
            transition: all 0.3s ease;
        }

        #viewMoreRegion:hover {
            color: var(--secondary-color) !important;
            transform: translateY(-1px);
        }

        .region-modal .table {
            font-size: 0.9rem;
        }

        .region-modal .table th {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-weight: 600;
            border: none;
            padding: 1rem 0.75rem;
        }

        .region-modal .table td {
            padding: 0.75rem;
            border-bottom: 1px solid #FFE4E6;
            vertical-align: top;
        }

        .region-modal .table tbody tr:hover {
            background-color: rgba(230, 57, 70, 0.05);
        }

        .region-modal .kv-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            text-align: center;
            min-width: 60px;
        }

        .region-modal .kv1 {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .region-modal .kv2nt {
            background: linear-gradient(135deg, #FFA726, #FF8F00);
            color: white;
        }

        .region-modal .kv2 {
            background: linear-gradient(135deg, #66BB6A, #43A047);
            color: white;
        }

        .region-modal .kv3 {
            background: linear-gradient(135deg, #42A5F5, #1E88E5);
            color: white;
        }

        .region-modal .search-box {
            margin-bottom: 1.5rem;
        }

        /* Certificate Modal Styles */
        #viewMoreCertificate {
            transition: all 0.3s ease;
        }

        #viewMoreCertificate:hover {
            color: var(--secondary-color) !important;
            transform: translateY(-1px);
        }

        .certificate-modal .table {
            font-size: 0.85rem;
        }

        .certificate-modal .table th {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            font-weight: 600;
            border: none;
            padding: 0.75rem 0.5rem;
            text-align: center;
            vertical-align: middle;
        }

        .certificate-modal .table td {
            padding: 0.6rem 0.4rem;
            border-bottom: 1px solid #FFE4E6;
            vertical-align: middle;
            text-align: center;
        }

        .certificate-modal .table tbody tr:hover {
            background-color: rgba(230, 57, 70, 0.05);
        }

        .certificate-modal .table tbody tr:first-child {
            background-color: rgba(40, 167, 69, 0.1);
        }

        .certificate-modal .table tbody tr:first-child:hover {
            background-color: rgba(40, 167, 69, 0.15);
        }

        /* Certificate table grouping styles */
        .certificate-modal .table th,
        .certificate-modal .table td {
            border: 1px solid #dee2e6;
            vertical-align: middle;
            text-align: center;
        }

        .certificate-modal .table thead th {
            border: 2px solid #fff;
        }

        /* Group borders for better readability */
        .certificate-modal .table th:nth-child(1),
        .certificate-modal .table td:nth-child(1) {
            border-left: 3px solid var(--primary-color);
        }

        .certificate-modal .table th:nth-child(4),
        .certificate-modal .table td:nth-child(4) {
            border-left: 2px solid #6c757d;
        }

        .certificate-modal .table th:nth-child(6),
        .certificate-modal .table td:nth-child(6) {
            border-left: 2px solid #6c757d;
        }

        .certificate-modal .table th:nth-child(8),
        .certificate-modal .table td:nth-child(8) {
            border-left: 2px solid #6c757d;
        }

        .certificate-modal .table th:nth-child(10),
        .certificate-modal .table td:nth-child(10) {
            border-left: 2px solid #6c757d;
        }

        .certificate-modal .table th:nth-child(11),
        .certificate-modal .table td:nth-child(11) {
            border-left: 3px solid #28a745;
        }

        .certificate-modal .table th:nth-child(15),
        .certificate-modal .table td:nth-child(15) {
            border-left: 2px solid #6c757d;
        }

        /* Alternating row colors for better readability */
        .certificate-modal .table tbody tr:nth-child(odd) {
            background-color: rgba(248, 249, 250, 0.5);
        }

        .certificate-modal .table tbody tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.8);
        }

        /* Highlight important score rows */
        .certificate-modal .table tbody tr:nth-child(1),
        .certificate-modal .table tbody tr:nth-child(3),
        .certificate-modal .table tbody tr:nth-child(6),
        .certificate-modal .table tbody tr:nth-child(9) {
            background-color: rgba(40, 167, 69, 0.08);
            font-weight: 500;
        }

        .certificate-modal .table tbody tr:nth-child(1):hover,
        .certificate-modal .table tbody tr:nth-child(3):hover,
        .certificate-modal .table tbody tr:nth-child(6):hover,
        .certificate-modal .table tbody tr:nth-child(9):hover {
            background-color: rgba(40, 167, 69, 0.15);
        }

        /* Header grouping colors */
        .certificate-modal .table thead th:nth-child(1) {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .certificate-modal .table thead th:nth-child(2),
        .certificate-modal .table thead th:nth-child(3) {
            background: linear-gradient(135deg, #fd7e14, #e55a00);
        }

        .certificate-modal .table thead th:nth-child(4),
        .certificate-modal .table thead th:nth-child(5) {
            background: linear-gradient(135deg, #6f42c1, #5a2d91);
        }

        .certificate-modal .table thead th:nth-child(6),
        .certificate-modal .table thead th:nth-child(7) {
            background: linear-gradient(135deg, #20c997, #17a085);
        }

        .certificate-modal .table thead th:nth-child(8),
        .certificate-modal .table thead th:nth-child(9) {
            background: linear-gradient(135deg, #0dcaf0, #0aa2c0);
        }

        .certificate-modal .table thead th:nth-child(10) {
            background: linear-gradient(135deg, #6610f2, #520dc2);
        }

        .certificate-modal .table thead th:nth-child(11),
        .certificate-modal .table thead th:nth-child(12),
        .certificate-modal .table thead th:nth-child(13),
        .certificate-modal .table thead th:nth-child(14) {
            background: linear-gradient(135deg, #28a745, #1e7e34);
        }

        .certificate-modal .table thead th:nth-child(15),
        .certificate-modal .table thead th:nth-child(16) {
            background: linear-gradient(135deg, #ffc107, #d39e00);
        }

        /* Responsive improvements for certificate table */
        @media (max-width: 768px) {
            .certificate-modal .table {
                font-size: 0.7rem;
            }

            .certificate-modal .table th,
            .certificate-modal .table td {
                padding: 0.3rem 0.2rem;
                white-space: nowrap;
            }

            .certificate-modal .table-responsive {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

        /* Tooltip styles for certificate table */
        .certificate-tooltip {
            position: relative;
            cursor: help;
        }

        .certificate-tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
        }

        .certificate-tooltip:hover::before {
            content: '';
            position: absolute;
            bottom: 95%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            pointer-events: none;
        }

        /* Merged cells styling */
        .certificate-modal .table td[rowspan] {
            font-weight: 600;
            background: linear-gradient(135deg, rgba(40, 167, 69, 0.1), rgba(40, 167, 69, 0.05));
            border: 2px solid rgba(40, 167, 69, 0.3);
            position: relative;
        }

        .certificate-modal .table td[rowspan]:hover {
            background: linear-gradient(135deg, rgba(40, 167, 69, 0.15), rgba(40, 167, 69, 0.08));
            transform: scale(1.02);
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2);
        }

        /* Special styling for level indicators */
        .certificate-modal .table td[rowspan]:contains("Bậc") {
            background: linear-gradient(135deg, rgba(0, 123, 255, 0.1), rgba(0, 123, 255, 0.05));
            border-color: rgba(0, 123, 255, 0.3);
        }

        /* Empty cells styling */
        .certificate-modal .table td:empty {
            background-color: rgba(248, 249, 250, 0.8);
            border-color: #e9ecef;
        }
    </style>
    <script>
        ['keydown', 'keyup', 'keypress'].forEach(function(evt) {
            window.addEventListener(evt, function(e) {
                // F12
                if (e.key === 'F12') {
                    e.preventDefault();
                    return false;
                }
                // Ctrl+Shift+I/J/C
                if (e.ctrlKey && e.shiftKey && ['I','J','C','i','j','c'].includes(e.key)) {
                    e.preventDefault();
                    return false;
                }
                // Ctrl+U/S/P/C/V/X/A
                if (e.ctrlKey && ['U','S','P','C','V','X','A','u','s','p','c','v','x','a'].includes(e.key)) {
                    e.preventDefault();
                    return false;
                }
            });
        });
        window.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
        window.addEventListener('selectstart', function(e) {
            e.preventDefault();
            return false;
        });
        window.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });
    </script>
</head>
<body>
    <div class="floating-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
    </div>

    <div class="container py-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-body p-4">
                        <!-- Logo và Tiêu đề trong card -->
                        <div class="text-center mb-4">
                            <img src="logo.png" alt="Logo" class="mb-3" style="max-height: 40px; height: auto;">
                            <h1 class="display-5 fw-bold mb-3" style="color: #E63946;">QUY ĐỔI ĐIỂM CÁC PHƯƠNG THỨC</h1>
                            <p class="lead text-muted">Tra cứu nhanh chóng và chính xác dựa trên phổ điểm 2025</p>
                        </div>
                        <form id="conversionForm">
                            <div class="mb-4">
                                <label for="truong" class="form-label">
                                    <i class="fas fa-university me-2"></i>Chọn trường
                                </label>
                                <select class="form-select" id="truong" name="truong" required>
                                    <option value="">Đang tải danh sách các trường...</option>
                                </select>
                            </div>

                            <div class="mb-4" id="vnu-school-group" style="display:none;">
                                <label for="vnu-school" class="form-label">
                                    <i class="fas fa-building me-2"></i>Trường dự định xét tuyển
                                </label>
                                <select class="form-select" id="vnu-school" name="vnu-school">
                                    <option value="">Chọn trường thành viên</option>
                                    <option value="VNU-HUS">Trường Đại học Khoa học Tự nhiên (VNU-HUS)</option>
                                    <option value="VNU-USSH">Trường Đại học Khoa học Xã hội và Nhân văn (VNU-USSH)</option>
                                    <option value="VNU-ULIS">Trường Đại học Ngoại ngữ (VNU-ULIS)</option>
                                    <option value="VNU-UET">Trường Đại học Công nghệ (VNU-UET)</option>
                                    <option value="VNU-UEB">Trường Đại học Kinh tế (VNU-UEB)</option>
                                    <option value="VNU-UEd">Trường Đại học Giáo dục (VNU-UEd)</option>
                                    <option value="VNU-VJU">Trường Đại học Việt - Nhật (VNU-VJU)</option>
                                    <option value="VNU-UMP">Trường Đại học Y Dược (VNU-UMP)</option>
                                    <option value="VNU-UL">Trường Đại học Luật (VNU-UL)</option>
                                </select>
                            </div>

                            <div class="mb-4">
                                <label for="phuongthuc" class="form-label">
                                    <i class="fas fa-list-alt me-2"></i>Chọn phương thức xét tuyển
                                </label>
                                <select class="form-select" id="phuongthuc" name="phuongthuc" required disabled>
                                    <option value="">Vui lòng chọn trường...</option>
                                </select>
                            </div>

                            <div class="mb-4">
                                <label for="diem" class="form-label">
                                    <i class="fas fa-star me-2"></i>Nhập điểm (Điểm gốc trên bảng điểm)
                                </label>
                                <input type="number" class="form-control" id="diem" name="diem" 
                                       placeholder="Nhập điểm cần quy đổi" step="0.01" required>
                            </div>

                            <div class="mb-4" id="ccnn-group" style="display:none;">
                                <label for="ccnn" class="form-label">
                                    <i class="fas fa-certificate me-2"></i>Chứng chỉ ngoại ngữ (nếu có)
                                    <a href="#" id="viewMoreCertificate" class="text-primary ms-2" style="font-size: 0.9em; text-decoration: none;">
                                        <i class="fas fa-info-circle me-1"></i>Xem thêm
                                    </a>
                                </label>
                                <select class="form-select" id="ccnn" name="ccnn">
                                    <option value="0">Không có</option>
                                    <option value="1">5.0</option>
                                    <option value="2">5.5</option>
                                    <option value="3">6.0</option>
                                    <option value="4">6.5</option>
                                    <option value="5">7.0</option>
                                    <option value="6">7.5</option>
                                    <option value="7">Từ 8.0 trở lên</option>
                                </select>
                            </div>

                            <div class="mb-4" id="diemvung-group" style="display:none;">
                                <label class="form-label">
                                    <i class="fas fa-plus-circle me-2"></i>Điểm ưu tiên
                                </label>
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="diemvung" class="form-label small">
                                            Điểm vùng (theo trường THPT)
                                            <a href="#" id="viewMoreRegion" class="text-primary ms-2" style="font-size: 0.9em; text-decoration: none;">
                                                <i class="fas fa-info-circle me-1"></i>Xem thêm
                                            </a>
                                        </label>
                                        <select class="form-select" id="diemvung" name="diemvung">
                                            <option value="0">Khu vực 3</option>
                                            <option value="0.75">Khu vực 1</option>
                                            <option value="0.25">Khu vực 2</option>
                                            <option value="0.5">Khu vực 2 - Nông Thôn</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="doituong" class="form-label small">
                                            Đối tượng ưu tiên
                                            <a href="#" id="viewMorePriority" class="text-primary ms-2" style="font-size: 0.9em; text-decoration: none;">
                                                <i class="fas fa-info-circle me-1"></i>Xem thêm
                                            </a>
                                        </label>
                                        <select class="form-select" id="doituong" name="doituong">
                                            <option value="0">Không có</option>
                                            <option value="2">Đối tượng 1</option>
                                            <option value="2">Đối tượng 2</option>
                                            <option value="2">Đối tượng 3</option>
                                            <option value="2">Đối tượng 4</option>
                                            <option value="1">Đối tượng 5</option>
                                            <option value="1">Đối tượng 6</option>
                                            <option value="1">Đối tượng 7</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="text-center">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-calculator me-2"></i>Tra cứu
                                </button>
                            </div>
                        </form>

                        <!-- Thông tin bổ sung trong cùng card -->
                        <div class="mt-4 pt-4 border-top">
                            <h5 class="card-title">
                                <i class="fas fa-info-circle me-2"></i>Thông tin liên quan
                            </h5>
                            <p class="info-text">
                                Tư vấn chọn trường theo SBD thi THPTQG 2025
                            </p>
                            <div class="mt-3">
                                <a href="https://tuvanchontruong.viettelstudy.vn/" target="_blank" rel="noopener" class="btn btn-outline-primary me-2">
                                    <i class="fas fa-search me-2"></i>Tư vấn chọn trường theo điểm THPT
                                </a>
                                <a href="https://www.facebook.com/share/p/1GoCtCbe82/" target="_blank" rel="noopener" class="btn btn-outline-success">
                                    <i class="fas fa-graduation-cap me-2"></i>Xuất phát sớm TSA 2026
                                </a>
                            </div>
                        </div>

                        <!-- Logo AECK trong card -->
                        <div class="text-center mt-4 pt-4 border-top">
                            <img src="AECK.svg" alt="Thương hiệu AECK" style="max-width: 280px; height: auto; opacity: 0.9;">
                        </div>
                    </div>
                </div>

                <div id="resultCard" class="card result-card">
                    <div class="card-body p-4">
                        <h4 class="card-title mb-4">
                            <i class="fas fa-chart-line me-2"></i>Kết quả quy đổi
                        </h4>
                        <div id="resultContent"></div>
                        <div class="text-center mt-4">
                            <button type="button" id="printBtn" class="share-btn">
                                <i class="fas fa-print me-2"></i>In kết quả
                            </button>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>

    <!-- Modal thông báo cập nhật -->
    <div class="modal fade" id="updateNotificationModal" tabindex="-1" aria-labelledby="updateNotificationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background: linear-gradient(135deg, #E63946, #F77F00); color: white;">
                    <h5 class="modal-title" id="updateNotificationModalLabel">
                        <i class="fas fa-rocket me-2"></i>Dữ liệu mới 2025 - Cập nhật hoàn toàn!
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-success">
                        <i class="fas fa-calendar-alt me-2"></i>
                        <strong>Cập nhật mới:</strong> Tháng 1/2025
                    </div>

                    <div class="alert alert-primary">
                        <i class="fas fa-star me-2"></i>
                        <strong>Tin tuyệt vời!</strong> Dữ liệu quy đổi điểm đã được cập nhật hoàn toàn mới cho năm 2025!
                    </div>

                    <div class="mb-3">
                        <h6 class="text-primary"><i class="fas fa-university me-2"></i>Dữ liệu mới 2025:</h6>
                        <p class="mb-3">Tất cả thông tin quy đổi điểm đã được cập nhật với <strong>dữ liệu chính thức năm 2025</strong> từ các trường đại học.</p>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="card border-success">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0"><i class="fas fa-check-circle me-2"></i>Dữ liệu 2025 hoàn toàn mới</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-unstyled mb-0">
                                            <li><i class="fas fa-check text-success me-2"></i><strong>Tất cả các trường đại học</strong></li>
                                            <li><i class="fas fa-check text-success me-2"></i><strong>Phương thức xét tuyển mới nhất</strong></li>
                                            <li><i class="fas fa-check text-success me-2"></i><strong>Bảng quy đổi điểm cập nhật</strong></li>
                                            <li><i class="fas fa-check text-success me-2"></i><strong>Dữ liệu chính thức từ Bộ GD&ĐT</strong></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>Lưu ý:</strong> Dữ liệu được đồng bộ từ hệ thống chính thức và cập nhật liên tục để đảm bảo độ chính xác cao nhất cho việc tra cứu và quy đổi điểm năm 2025.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal">
                        <i class="fas fa-thumbs-up me-2"></i>Tuyệt vời! Bắt đầu tra cứu
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Bảng Phân Vị -->
    <div class="modal fade" id="percentileTableModal" tabindex="-1" aria-labelledby="percentileTableModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="percentileTableModalLabel">
                        <i class="fas fa-chart-bar me-2"></i>Bảng Phân Vị TSA - Đại học Bách Khoa Hà Nội 2024-2025
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Giải thích:</strong> Bảng dưới đây hiển thị phân vị điểm TSA với hai mức ước tính (cận trên và cận dưới) cho mỗi phần trăm thí sinh.
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped table-hover" id="percentileTable">
                            <thead class="table-dark">
                                <tr>
                                    <th>Phân vị (%)</th>
                                    <th>Mức điểm cận trên</th>
                                    <th>Mức điểm cận dưới</th>
                                    <th>Ý nghĩa</th>
                                </tr>
                            </thead>
                            <tbody id="percentileTableBody">
                                <!-- Dữ liệu sẽ được tạo bằng JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="exportPercentileTable()">
                        <i class="fas fa-download me-2"></i>Xuất Excel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Bảng Điểm Chuẩn Đầy Đủ -->
    <div class="modal fade" id="fullBenchmarkModal" tabindex="-1" aria-labelledby="fullBenchmarkModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="fullBenchmarkModalLabel">
                        <i class="fas fa-table me-2"></i>Bảng Điểm Chuẩn Đại học Bách Khoa Hà Nội (2023-2024)
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Thông tin:</strong> Bảng dưới đây hiển thị điểm chuẩn của tất cả các ngành qua 2 năm để bạn tham khảo xu hướng.
                    </div>

                    <!-- Tìm kiếm -->
                    <div class="search-box mb-3">
                        <i class="fas fa-search"></i>
                        <input type="text" id="fullBenchmarkSearch" placeholder="Tìm kiếm ngành hoặc mã ngành..." class="form-control">
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped table-hover" id="fullBenchmarkTable">
                            <thead class="table-dark">
                                <tr>
                                    <th>Ngành</th>
                                    <th>Mã ngành</th>
                                    <th>THPT 2024</th>
                                    <th>THPT 2023</th>
                                    <th>TSA 2024</th>
                                    <th>TSA 2023</th>
                                    <th>Xu hướng THPT</th>
                                    <th>Xu hướng TSA</th>
                                </tr>
                            </thead>
                            <tbody id="fullBenchmarkTableBody">
                                <!-- Dữ liệu sẽ được tạo bằng JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="exportFullBenchmarkTable()">
                        <i class="fas fa-download me-2"></i>Xuất Excel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Đối tượng ưu tiên -->
    <div class="modal fade priority-modal" id="priorityObjectModal" tabindex="-1" aria-labelledby="priorityObjectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="priorityObjectModalLabel">
                        <i class="fas fa-users me-2"></i>Chi tiết đối tượng ưu tiên tuyển sinh
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Thông tin:</strong> Các đối tượng ưu tiên được chia thành 2 nhóm chính với mức điểm ưu tiên khác nhau.
                    </div>

                    <!-- Nhóm ưu tiên 1 -->
                    <div class="card mb-4">
                        <div class="card-header priority-header-1">
                            <h6 class="mb-0"><i class="fas fa-star me-2"></i>Nhóm ưu tiên 1 (UT1) - Cộng 2 điểm (Thang 30)</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="priority-text-1">Đối tượng 01:</h6>
                                    <p class="mb-3">Công dân Việt Nam là người dân tộc thiểu số.</p>

                                    <h6 class="priority-text-1">Đối tượng 02:</h6>
                                    <p class="mb-3">Công nhân ưu tú trực tiếp sản xuất đã làm việc liên tục 5 năm trở lên trong đó có 2 năm trở lên là chiến sĩ thi đua được cấp tỉnh trở lên công nhận và cấp bằng khen.</p>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="priority-text-1">Đối tượng 03:</h6>
                                    <ul class="mb-3">
                                        <li>Thương binh, bệnh binh, người có thẻ chứng nhận được hưởng chính sách như thương binh;</li>
                                        <li>Quân nhân, công an nhân dân tại ngũ được cử đi học có thời gian phục vụ từ 12 tháng trở lên tại khu vực 1;</li>
                                        <li>Quân nhân, công an nhân dân tại ngũ được cử đi học có thời gian phục vụ từ 24 tháng trở lên;</li>
                                        <li>Quân nhân, công an nhân dân hoàn thành nghĩa vụ đã xuất ngũ có thời gian phục vụ từ 24 tháng trở lên;</li>
                                    </ul>

                                    <h6 class="priority-text-1">Đối tượng 04:</h6>
                                    <ul class="mb-3">
                                        <li>Con liệt sĩ;</li>
                                        <li>Con thương binh mất sức lao động 81% trở lên;</li>
                                        <li>Con bệnh binh mất sức lao động 81% trở lên;</li>
                                        <li>Con của người có thẻ chứng nhận được hưởng chính sách như thương binh mất sức lao động 81% trở lên;</li>
                                        <li>Con của Bà mẹ Việt Nam anh hùng, con của Anh hùng lực lượng vũ trang, con của Anh hùng lao động.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Nhóm ưu tiên 2 -->
                    <div class="card mb-4">
                        <div class="card-header priority-header-2">
                            <h6 class="mb-0"><i class="fas fa-medal me-2"></i>Nhóm ưu tiên 2 (UT2) - Cộng 1 điểm (Thang 30)</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="priority-text-2">Đối tượng 05:</h6>
                                    <ul class="mb-3">
                                        <li>Thanh niên xung phong tập trung được cử đi học;</li>
                                        <li>Quân nhân, công an nhân dân tại ngũ được cử đi học có thời gian phục vụ dưới 24 tháng không ở khu vực 1;</li>
                                    </ul>

                                    <h6 class="priority-text-2">Đối tượng 06:</h6>
                                    <ul class="mb-3">
                                        <li>Con thương binh mất sức lao động dưới 81%;</li>
                                        <li>Con bệnh binh mất sức lao động dưới 81%;</li>
                                        <li>Con của người có thẻ chứng nhận được hưởng chính sách như thương binh mất sức lao động dưới 81%.</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="priority-text-2">Đối tượng 07:</h6>
                                    <ul class="mb-3">
                                        <li>Người lao động ưu tú thuộc tất cả các thành phần kinh tế được từ cấp tỉnh, thành phố, Bộ trở lên công nhận danh hiệu thợ giỏi, nghệ nhân, được cấp bằng và huy hiệu Lao động sáng tạo của Tổng Liên đoàn Lao động Việt Nam hoặc Trung ương Đoàn TNCS Hồ Chí Minh;</li>
                                        <li>Giáo viên đã giảng dạy đủ 3 năm trở lên thi vào các ngành sư phạm;</li>
                                        <li>Y tá, dược tá, hộ lý, kỹ thuật viên, y sĩ, dược sĩ trung cấp đã công tác đủ 3 năm trở lên thi vào các ngành y, dược.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Lưu ý thời hạn -->
                    <div class="alert alert-warning">
                        <i class="fas fa-clock me-2"></i>
                        <strong>Lưu ý về thời hạn:</strong> Thời hạn tối đa được hưởng ưu tiên đối với quân nhân, công an phục viên, xuất ngũ, chuyển ngành dự thi là <strong>18 tháng</strong> kể từ ngày ký quyết định xuất ngũ đến ngày dự thi.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Điểm vùng -->
    <div class="modal fade region-modal" id="regionModal" tabindex="-1" aria-labelledby="regionModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="regionModalLabel">
                        <i class="fas fa-map-marker-alt me-2"></i>Phân chia khu vực ưu tiên theo tỉnh thành
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Thông tin:</strong> Bảng dưới đây hiển thị phân chia khu vực ưu tiên (KV1, KV2-NT, KV2, KV3) cho từng tỉnh thành và các đơn vị hành chính thuộc từng khu vực.
                    </div>

                    <!-- Search box -->
                    <div class="search-box">
                        <div class="position-relative">
                            <i class="fas fa-search position-absolute" style="left: 1rem; top: 50%; transform: translateY(-50%); color: #9CA3AF;"></i>
                            <input type="text" id="regionSearch" class="form-control" placeholder="Tìm kiếm theo tên tỉnh hoặc đơn vị hành chính..." style="padding-left: 2.5rem;">
                        </div>
                    </div>

                    <!-- Legend -->
                    <div class="row mb-3">
                        <div class="col-12">
                            <h6 class="text-primary mb-2">Chú thích khu vực (Theo thang 30 điểm):</h6>
                            <div class="d-flex flex-wrap gap-3">
                                <div class="d-flex align-items-center">
                                    <span class="kv-badge kv1 me-2">KV1</span>
                                    <span class="small">Khu vực 1 (+0.75 điểm)</span>
                                </div>
                                <div class="d-flex align-items-center">
                                    <span class="kv-badge kv2-nt me-2">KV2-NT</span>
                                    <span class="small">Khu vực 2 - Nông thôn (+0.5 điểm)</span>
                                </div>
                                <div class="d-flex align-items-center">
                                    <span class="kv-badge kv2 me-2">KV2</span>
                                    <span class="small">Khu vực 2 (+0.25 điểm)</span>
                                </div>
                                <div class="d-flex align-items-center">
                                    <span class="kv-badge kv3 me-2">KV3</span>
                                    <span class="small">Khu vực 3 (0 điểm)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="table-responsive">
                        <table class="table table-striped" id="regionTable">
                            <thead>
                                <tr>
                                    <th style="width: 8%;">Mã</th>
                                    <th style="width: 20%;">Tỉnh thành</th>
                                    <th style="width: 12%;">Khu vực</th>
                                    <th style="width: 60%;">Đơn vị hành chính</th>
                                </tr>
                            </thead>
                            <tbody id="regionTableBody">
                                <!-- Dữ liệu sẽ được tạo bằng JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="exportRegionTable()">
                        <i class="fas fa-download me-2"></i>Xuất Excel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Chứng chỉ ngoại ngữ -->
    <div class="modal fade certificate-modal" id="certificateModal" tabindex="-1" aria-labelledby="certificateModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="certificateModalLabel">
                        <i class="fas fa-certificate me-2"></i>Bảng quy đổi chứng chỉ ngoại ngữ
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Thông tin:</strong> Bảng dưới đây hiển thị mức điểm quy đổi cho các loại chứng chỉ ngoại ngữ quốc tế được công nhận (Dữ liệu chưa hoàn thiện, đang cập nhật...).
                    </div>

                    <!-- Table -->
                    <div class="table-responsive">
                        <table class="table table-striped table-hover" id="certificateTable">
                            <thead>
                                <tr>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">IELTS Academic</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">KNLNN VN</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">Khung Năng lực Châu Âu</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">VSTEP</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">Aptis ESOL</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">PTE Academic</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">PTE</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">Linguaskill</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">Cambridge Assessment English</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">Cambridge English Tests</th>
                                    <th colspan="4" style="text-align: center;">TOEIC</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">TOEFL iBT (*)</th>
                                    <th rowspan="2" style="vertical-align: middle; text-align: center;">TOEFL ITP</th>
                                </tr>
                                <tr>
                                    <th style="text-align: center;">Nghe</th>
                                    <th style="text-align: center;">Nói</th>
                                    <th style="text-align: center;">Đọc</th>
                                    <th style="text-align: center;">Viết</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>5.0</td>
                                    <td>Bậc 3</td>
                                    <td>B1</td>
                                    <td>5.5</td>
                                    <td>B1</td>
                                    <td>Level 2</td>
                                    <td>43 - 58</td>
                                    <td>140 - 159</td>
                                    <td>B1 Preliminary<br>B1 Business Preliminary</td>
                                    <td>PET<br>(140 - 159)</td>
                                    <td>275 - 395</td>
                                    <td>275 - 380</td>
                                    <td>120 - 150</td>
                                    <td>120 - 140</td>
                                    <td>30 - 45</td>
                                    <td>450 - 499</td>
                                </tr>
                                <tr>
                                    <td>5.5</td>
                                    <td rowspan="3">Bậc 4</td>
                                    <td rowspan="3">B2</td>
                                    <td rowspan="2">6.0 - 6.5</td>
                                    <td rowspan="3">B2</td>
                                    <td rowspan="3">Level 3</td>
                                    <td rowspan="3">59 - 75</td>
                                    <td rowspan="3">160 - 179</td>
                                    <td rowspan="3">B2 First/B2<br>Business Vantage</td>
                                    <td rowspan="3">FCE<br>(160 - 179)</td>
                                    <td rowspan="3">400 - 485</td>
                                    <td rowspan="3">385 - 450</td>
                                    <td rowspan="3">160 - 170</td>
                                    <td rowspan="3">150 - 170</td>
                                    <td rowspan="3">46 - 93</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>6.0</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>6.5</td>
                                    <td>7.0 - 7.5</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>7.0</td>
                                    <td rowspan="3">Bậc 5</td>
                                    <td rowspan="3">C1</td>
                                    <td>8.5</td>
                                    <td rowspan="3">C1</td>
                                    <td rowspan="3">Level 4</td>
                                    <td rowspan="3">76 - 84</td>
                                    <td rowspan="3">>180</td>
                                    <td rowspan="3">C1 Advanced/<br>C1 Business Higher</td>
                                    <td rowspan="3">CAE<br>(180 - 199)</td>
                                    <td>490</td>
                                    <td>455</td>
                                    <td rowspan="3">180 - 200</td>
                                    <td rowspan="3">180 - 200</td>
                                    <td rowspan="3">94 - 114</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>7.5</td>
                                    <td rowspan="2">9.0</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>8.0</td>
                                    <td rowspan="2">9.5 - 10</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>8.5</td>
                                    <td rowspan="2">Bậc 6</td>
                                    <td rowspan="2">C2</td>
                                    <td></td>
                                    <td rowspan="2">C2</td>
                                    <td rowspan="2">Level 5</td>
                                    <td rowspan="2">85 - 90</td>
                                    <td></td>
                                    <td rowspan="2">C2 Proficiency</td>
                                    <td rowspan="2">CPE<br>(200 - 230)</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td rowspan="2">115 - 120</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>9.0</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="alert alert-warning mt-3">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Lưu ý:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Bảng quy đổi này áp dụng cho các chứng chỉ ngoại ngữ quốc tế được Bộ Giáo dục và Đào tạo công nhận.</li>
                            <li>Chứng chỉ phải còn hiệu lực tại thời điểm nộp hồ sơ xét tuyển.</li>
                            <li>Thí sinh chỉ được sử dụng một loại chứng chỉ để xét tuyển.</li>
                            <li>(*) TOEFL iBT: Điểm tối thiểu mỗi kỹ năng phải đạt từ 6.0 trở lên.</li>
                        </ul>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-primary" onclick="exportCertificateTable()">
                        <i class="fas fa-download me-2"></i>Xuất Excel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbzMY8TErxagRPZdiUVi8n6e10nsta7J5nzckzpPvxbmnj2wEaGheBIqQcHOBbbn1E9K/exec";

        // Biến lưu trữ toàn bộ dữ liệu
        let allData = [];

        // Hàm chuyển chuỗi có dấu sang không dấu
        function toSlug(str) {
            return str.replace(/Đ/g, "D")
                    .replace(/đ/g, "d")
                    .normalize("NFD")
                    .replace(/[̀-ͯ]/g, "")
                    .replace(/[^a-zA-Z0-9]/g, "")
                    .toLowerCase();
        }

        // Hàm quy đổi điểm ở phía client (từ web HM)
        function convertScoreClient(allData, truong, method, score) {
            // 1. Lọc rows cùng trường
            const rows = allData.filter(r => r["Trường"] === truong);
            if (!rows.length) {
                return { error: `Không tìm thấy dữ liệu cho trường "${truong}"` };
            }

            // 2. Tìm sourceRow
            const src = rows.find(r => r["Phương thức"] === method);
            if (!src) {
                return { error: `Không tìm thấy phương thức "${method}"` };
            }

            // 3. Lấy và strip BOM + trim key, rồi lọc "Khoảng"
            const rangeKeys = Object.keys(src).filter(k => {
                const cleanKey = k.replace(/^\uFEFF/, "").trim().toLowerCase();
                const v = src[k] + "";
                return cleanKey.startsWith("khoảng")
                    && v.trim() !== ""
                    && /[–—-]/.test(v);
            });

            // 4. Tìm khoảng chứa điểm
            let pickKey = null, minSrc = 0, maxSrc = 0;
            for (let k of rangeKeys) {
                const raw = (src[k] + "").replace(/[–—]/g, "-");
                const [a, b] = raw.split("-").map(s => s.trim());
                const n1 = parseFloat(a.replace(/[^0-9.]/g, ""));
                const n2 = parseFloat(b.replace(/[^0-9.]/g, ""));
                if (!isNaN(n1) && !isNaN(n2) && score >= n1 && score <= n2) {
                    pickKey = k; minSrc = n1; maxSrc = n2;
                    break;
                }
            }
            if (!pickKey) {
                return { error: "Điểm của bạn chưa nằm trong bất kỳ khoảng nào." };
            }

            // 5. Nội suy cho các phương thức khác
            const result = {};
            rows.forEach(r => {
                if (r["Phương thức"] === method) return;
                const raw = (r[pickKey] + "").replace(/[–—]/g, "-");
                const [a, b] = raw.split("-").map(s => s.trim());
                const t1 = parseFloat(a.replace(/[^0-9.]/g, ""));
                const t2 = parseFloat(b.replace(/[^0-9.]/g, ""));
                if (!isNaN(t1) && !isNaN(t2)) {
                    const v = t1 + (score - minSrc) * (t2 - t1) / (maxSrc - minSrc);
                    result[r["Phương thức"]] = parseFloat(v.toFixed(2));
                }
            });

            return result;
        }

        // Lấy danh sách trường khi trang được tải
        document.addEventListener('DOMContentLoaded', function() {
            // Hiển thị modal thông báo cập nhật khi trang được tải
            const updateModal = new bootstrap.Modal(document.getElementById('updateNotificationModal'));
            updateModal.show();

            const truongSelect = document.getElementById('truong');
            const phuongthucSelect = document.getElementById('phuongthuc');
            const diemInput = document.getElementById('diem');
            const ccnnGroup = document.getElementById('ccnn-group');
            const ccnnSelect = document.getElementById('ccnn');
            const diemvungGroup = document.getElementById('diemvung-group');
            const diemvungSelect = document.getElementById('diemvung');
            const doituongSelect = document.getElementById('doituong');
            const form = document.getElementById('conversionForm');
            const resultCard = document.getElementById('resultCard');
            const resultContent = document.getElementById('resultContent');
            const printBtn = document.getElementById('printBtn');
            const viewMorePriorityBtn = document.getElementById('viewMorePriority');
            const viewMoreRegionBtn = document.getElementById('viewMoreRegion');
            const viewMoreCertificateBtn = document.getElementById('viewMoreCertificate');

            // Xử lý sự kiện click vào "Xem thêm" đối tượng ưu tiên
            viewMorePriorityBtn.addEventListener('click', function(e) {
                e.preventDefault();
                const priorityModal = new bootstrap.Modal(document.getElementById('priorityObjectModal'));
                priorityModal.show();
            });

            // Xử lý sự kiện click vào "Xem thêm" điểm vùng
            viewMoreRegionBtn.addEventListener('click', function(e) {
                e.preventDefault();
                loadRegionData();
                const regionModal = new bootstrap.Modal(document.getElementById('regionModal'));
                regionModal.show();
            });

            // Xử lý sự kiện click vào "Xem thêm" chứng chỉ ngoại ngữ
            viewMoreCertificateBtn.addEventListener('click', function(e) {
                e.preventDefault();
                const certificateModal = new bootstrap.Modal(document.getElementById('certificateModal'));
                certificateModal.show();
            });

            // Hiển thị loading
            truongSelect.innerHTML = '<option value="">Đang tải danh sách các trường...</option>';

            // Lấy toàn bộ dữ liệu một lần
            fetch(`${API_URL}?action=getAllData`)
                .then(res => res.json())
                .then(data => {
                    allData = data;

                    // Đổ dropdown trường
                    const truongs = Array.from(new Set(data.map(r => r["Trường"])));
                    truongSelect.innerHTML = '<option value="">Chọn trường</option>';
                    truongs.forEach(truong => {
                        const option = document.createElement('option');
                        option.value = truong;
                        option.textContent = truong;
                        truongSelect.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Lỗi khi tải dữ liệu:', error);
                    truongSelect.innerHTML = '<option value="">Lỗi tải dữ liệu</option>';
                });

            // Xử lý khi chọn trường
            truongSelect.addEventListener('change', function() {
                const truong = this.value;
                diemInput.value = '';
                phuongthucSelect.disabled = true;
                phuongthucSelect.innerHTML = '<option value="">Đang tải danh sách các phương thức quy đổi...</option>';
                
                // Hiển thị/ẩn select box trường VNU
                const vnuSchoolGroup = document.getElementById('vnu-school-group');
                if (truong.toLowerCase().includes('quốc gia hà nội')) {
                    vnuSchoolGroup.style.display = '';
                } else {
                    vnuSchoolGroup.style.display = 'none';
                    document.getElementById('vnu-school').value = '';
                }

                // Lọc phương thức từ dữ liệu đã tải
                const methods = allData
                    .filter(r => r["Trường"] === truong)
                    .map(r => r["Phương thức"])
                    .filter(m => m?.trim());
                const uniqueMethods = Array.from(new Set(methods));

                phuongthucSelect.innerHTML = '<option value="">Chọn phương thức xét tuyển</option>';
                uniqueMethods.forEach(method => {
                    const option = document.createElement('option');
                    option.value = method;
                    option.textContent = method;
                    phuongthucSelect.appendChild(option);
                });
                phuongthucSelect.disabled = false;
            });

            // Xử lý khi chọn phương thức
            phuongthucSelect.addEventListener('change', function() {
                const methodValue = this.value.toLowerCase();
                const truongValue = truongSelect.value.toLowerCase();

                // Hiển thị chứng chỉ ngoại ngữ cho TSA/ĐGTD ở Bách Khoa
                const showCCNN = (methodValue.includes('tsa') || methodValue.includes('đgtd') || methodValue.includes('dgtd')) && truongValue.includes('bách khoa');
                ccnnGroup.style.display = showCCNN ? '' : 'none';

                // Hiển thị điểm ưu tiên cho THPT hoặc TSA/ĐGTD ở Bách Khoa
                const showDiemUuTien = methodValue.includes('thpt') ||
                                      ((methodValue.includes('tsa') || methodValue.includes('đgtd') || methodValue.includes('dgtd')) && truongValue.includes('bách khoa'));
                diemvungGroup.style.display = showDiemUuTien ? '' : 'none';

                if (!showCCNN) {
                    ccnnSelect.value = '0';
                }
                if (!showDiemUuTien) {
                    diemvungSelect.value = '0';
                    doituongSelect.value = '0';
                }
            });

            // Xử lý form submit
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                const truong = truongSelect.value;
                const method = phuongthucSelect.value;
                let score = parseFloat(diemInput.value);
                let bonus = 0;
                let vung = 0;
                let doituong = 0;
                // Nếu có input chứng chỉ và đang hiển thị, cộng điểm tương ứng
                if (ccnnGroup.style.display !== 'none') {
                    bonus = parseInt(ccnnSelect.value) || 0;
                }
                // Nếu có input điểm vùng và đang hiển thị, lấy điểm vùng và đối tượng ưu tiên
                if (diemvungGroup.style.display !== 'none') {
                    vung = parseFloat(diemvungSelect.value) || 0;
                    doituong = parseFloat(doituongSelect.value) || 0;
                }

                let tong = score + bonus;

                // Xử lý điểm ưu tiên theo phương thức
                if (diemvungGroup.style.display !== 'none') {
                    const methodValue = method.toLowerCase();

                    if (methodValue.includes('thpt')) {
                        // Với THPT: áp dụng công thức điểm ưu tiên mới
                        const tongDiemUuTien = vung + doituong; // Tổng điểm ưu tiên thông thường

                        if (tong >= 22.5) {
                            // Điểm từ 22.5 trở lên: áp dụng công thức giảm dần
                            const diemUuTienThucTe = ((30 - tong) / 7.5) * tongDiemUuTien;
                            tong = tong + diemUuTienThucTe;
                        } else {
                            // Điểm dưới 22.5: cộng thẳng điểm ưu tiên
                            tong = tong + tongDiemUuTien;
                        }
                    } else if (methodValue.includes('tsa') || methodValue.includes('đgtd') || methodValue.includes('dgtd')) {
                        // Với TSA: sử dụng công thức cũ
                        const vungTSA = 10*(vung + doituong)/3;
                        if (tong < 75) {
                            tong = tong + vungTSA;
                        } else {
                            tong = tong + (vungTSA * (100 - tong) / 25);
                        }
                    }
                }
                const finalScore = Math.round(tong * 100) / 100; // Điểm cuối cùng sau khi cộng ưu tiên
                score = Math.round(tong * 100) / 100; // Giữ nguyên để tương thích

                if (!truong || !method || isNaN(score)) {
                    alert('Vui lòng điền đầy đủ thông tin!');
                    return;
                }

                // Hiển thị loading
                resultCard.style.display = 'block';
                resultContent.innerHTML = `
                    <div class="loading-state">
                        <div class="modern-loader">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                        <p>Đang xử lý yêu cầu của bạn...</p>
                    </div>
                `;

                // Gọi hàm convertScoreClient
                const data = convertScoreClient(allData, truong, method, score);

                if (data.error) {
                    resultContent.innerHTML = `
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-circle me-2"></i>${data.error}
                        </div>
                    `;
                    return;
                }

                        // Tạo bảng kết quả
                        let html = `
                            <div class="result-animation">
                                <div class="result-header">
                                    <h4><i class="fas fa-chart-line me-2"></i>Kết quả quy đổi điểm</h4>
                                </div>
                                <div class="result-summary">
                                    <p><i class="fas fa-info-circle me-2"></i>Điểm ${score} của phương thức ${method} được quy đổi sang các phương thức khác như sau:</p>
                                </div>

                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Phương thức</th>
                                                <th class="text-end">Điểm tương đương</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                        `;

                        let delay = 0;
                        for (let key in data) {
                            html += `
                                <tr class="result-row" style="animation-delay: ${delay}s">
                                    <td class="method-name">${key}</td>
                                    <td class="text-end"><span class="score-value">${data[key]}</span></td>
                                </tr>
                            `;
                            delay += 0.1;
                        }

                        html += `
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        `;

                        // Hiển thị thông tin phân vị TSA nếu có (trừ phương thức XTTN)
                        console.log('Debug TSA:', {
                            method: method.toLowerCase(),
                            truong: truong.toLowerCase(),
                            score: score,
                            methodCheck: method.toLowerCase().includes('tsa') || method.toLowerCase().includes('đgtd') || method.toLowerCase().includes('dgtd'),
                            truongCheck: truong.toLowerCase().includes('bách khoa') || truong.toLowerCase().includes('bach khoa')
                        });

                        // Chỉ hiển thị phân vị TSA khi KHÔNG phải phương thức XTTN
                        const shouldShowTSA = !method.toLowerCase().includes('xttn') &&
                                             (method.toLowerCase().includes('tsa') || method.toLowerCase().includes('đgtd') || method.toLowerCase().includes('dgtd')) &&
                                             (truong.toLowerCase().includes('bách khoa') || truong.toLowerCase().includes('bach khoa'));

                        console.log('Should show TSA:', shouldShowTSA);
                        console.log('Current score for TSA:', score);

                        if (shouldShowTSA) {
                            const tsaPercentileInfo = calculateTSAPercentile(score);
                            console.log('TSA Percentile Info:', tsaPercentileInfo);
                            if (tsaPercentileInfo) {
                                html += `
                                    <div class="benchmark-card mt-4">
                                        <div class="benchmark-title">
                                            <i class="fas fa-chart-bar me-2"></i>Phân vị điểm TSA của bạn
                                        </div>
                                        <div class="result-summary">
                                            <div class="percentile-result-card">
                                                <div class="percentile-main-info">
                                                    <h5 class="mb-3"><i class="fas fa-trophy me-2 text-warning"></i>Phân vị điểm TSA của bạn</h5>
                                                    <div class="percentile-range">
                                                        <span class="percentile-text">Điểm <strong>${tsaPercentileInfo.score}</strong> của bạn nằm trong khoảng</span>
                                                        <div class="percentile-numbers">
                                                            <span class="percentile-from">Top ${tsaPercentileInfo.lower}%</span>
                                                            <span class="percentile-separator">đến</span>
                                                            <span class="percentile-to">Top ${tsaPercentileInfo.upper}%</span>
                                                        </div>
                                                        <span class="percentile-description">thí sinh trong kỳ thi TSA</span>
                                                    </div>
                                                </div>
                                                <div class="alert alert-success mt-3">
                                                    <i class="fas fa-lightbulb me-2"></i>
                                                    <strong>Ý nghĩa:</strong> Bạn đã vượt qua ${100 - tsaPercentileInfo.upper}% đến ${100 - tsaPercentileInfo.lower}% thí sinh khác trong kỳ thi TSA.
                                                </div>

                                                <div class="text-center mt-3">
                                                    <button type="button" class="btn btn-outline-primary me-2" data-bs-toggle="modal" data-bs-target="#percentileTableModal">
                                                        <i class="fas fa-table me-2"></i>Xem bảng phân vị đầy đủ
                                                    </button>
                                                    <a href="https://aeck.io.vn/rank/" target="_blank" rel="noopener" class="btn btn-outline-success">
                                                        <i class="fas fa-search me-2"></i>Tra cứu tỉ lệ điểm TSA
                                                    </a>
                                                </div>
                                            </div>
                                            <p class="small text-muted mt-2">Dữ liệu phân vị dựa trên thống kê của Đại học Bách Khoa Hà Nội năm 2024-2025</p>
                                        </div>
                                    </div>
                                `;
                            }
                        }



                        // Dữ liệu ngành UET
                        const uetMajors = [
                            { code: 'CN1', name: 'Công nghệ thông tin', tohop: 'A00; A01; D01', diem: 27.8 },
                            { code: 'CN10', name: 'Công nghệ nông nghiệp', tohop: 'A00; A01; B00', diem: 22.5 },
                            { code: 'CN11', name: 'Kỹ thuật điều khiển và tự động hoá', tohop: 'A00; A01; D01', diem: 27.05 },
                            { code: 'CN12', name: 'Trí tuệ nhân tạo', tohop: 'A00; A01; D01', diem: 27.12 },
                            { code: 'CN13', name: 'Kỹ thuật năng lượng', tohop: 'A00; A01; D01', diem: 24.59 },
                            { code: 'CN14', name: 'Hệ thống thông tin', tohop: 'A00; A01; D01', diem: 26.87 },
                            { code: 'CN15', name: 'Mạng máy tính và truyền thông dữ liệu', tohop: 'A00; A01; D01', diem: 26.92 },
                            { code: 'CN17', name: 'Kỹ thuật Robot', tohop: 'A00; A01; D01', diem: 25.99 },
                            { code: 'CN18', name: 'Thiết kế công nghiệp và đồ họa', tohop: 'A00; A01; D01', diem: 24.64 },
                            { code: 'CN2', name: 'Kỹ thuật máy tính', tohop: 'A00; A01; D01', diem: 26.97 },
                            { code: 'CN3', name: 'Vật lý kỹ thuật', tohop: 'A00; A01; D01', diem: 25.24 },
                            { code: 'CN4', name: 'Cơ kỹ thuật', tohop: 'A00; A01; D01', diem: 26.03 },
                            { code: 'CN5', name: 'Công nghệ kỹ thuật xây dựng', tohop: 'A00; A01; D01', diem: 23.91 },
                            { code: 'CN6', name: 'Công nghệ kỹ thuật cơ – điện tử', tohop: 'A00; A01; D01', diem: 26.27 },
                            { code: 'CN7', name: 'Công nghệ hàng không vũ trụ', tohop: 'A00; A01; D01', diem: 24.61 },
                            { code: 'CN8', name: 'Khoa học máy tính', tohop: 'A00; A01; D01', diem: 27.58 },
                            { code: 'CN9', name: 'Công nghệ kỹ thuật điện tử – viễn thông', tohop: 'A00; A01; D01', diem: 26.3 }
                        ];

                        // Tìm điểm THPT cao nhất trong các khối A00, A01, D01 từ output
                        let maxBlockScore = null;
                        let maxBlockName = '';
                        if (truongSelect.value.toLowerCase().includes('quốc gia hà nội') && document.getElementById('vnu-school').value === 'VNU-UET') {
                            const blockNames = ['A00', 'A01', 'D01'];
                            for (const block of blockNames) {
                                const key = Object.keys(data).find(k => k.toUpperCase().includes(block));
                                if (key && !isNaN(parseFloat(data[key]))) {
                                    const val = parseFloat(data[key]);
                                    if (maxBlockScore === null || val > maxBlockScore) {
                                        maxBlockScore = val;
                                        maxBlockName = block;
                                    }
                                }
                            }
                        }

                        // Hàm render bảng ngành UET
                        function renderUetMajorTable(userScore, blockName) {
                            const sortedMajors = [...uetMajors].sort((a, b) => b.diem - a.diem);
                            let html = `<div class="benchmark-card mt-4">
                                <div class="benchmark-title">
                                    <i class="fas fa-lightbulb me-2"></i>Gợi ý ngành phù hợp với điểm của bạn (Trường Đại học Công nghệ - ĐHQGHN)
                                </div>
                                <div class="table-responsive">
                                    <table class="benchmark-table">
                                        <thead>
                                            <tr>
                                                <th>Mã ngành</th>
                                                <th>Tên ngành</th>
                                                <th>Tổ hợp môn</th>
                                                <th>Điểm chuẩn 2024</th>
                                                <th>Điểm của bạn</th>
                                                <th>Đánh giá</th>
                                            </tr>
                                        </thead>
                                        <tbody>`;
                            sortedMajors.forEach(item => {
                                const status = getAdmissionStatus(userScore, item.diem, 'THPT');
                                html += `<tr>
                                    <td>${item.code}</td>
                                    <td>${item.name}</td>
                                    <td>${item.tohop}</td>
                                    <td>${item.diem}</td>
                                    <td>${(userScore !== null && userScore !== undefined && !isNaN(userScore)) ? userScore + (blockName ? ' (' + blockName + ')' : '') : ''}</td>
                                    <td><span class="score-status ${status.class}">${status.text}</span></td>
                                </tr>`;
                            });
                            html += `</tbody></table></div></div>`;
                            return html;
                        }

                        // Thêm vào sau khi có suggestScore (điểm THPT)
                        let showUetMajorTable = (
                            truongSelect.value.toLowerCase().includes('quốc gia hà nội') &&
                            document.getElementById('vnu-school').value === 'VNU-UET' &&
                            maxBlockScore !== null
                        );

                        if (showUetMajorTable) {
                            html += renderUetMajorTable(maxBlockScore, maxBlockName);
                        }

                        // Gợi ý ngành chung (benchmarkData) - không gợi ý cho XTTN
                        let suggestScore = null;
                        let suggestMethod = '';
                        let benchmarkField = '';

                        // Kiểm tra phương thức để quyết định có gợi ý hay không
                        const methodLower = method.toLowerCase();
                        const isHUSTMethod = truong.toLowerCase().includes('bách khoa') || truong.toLowerCase().includes('bach khoa');

                        // Chỉ gợi ý cho THPT và TSA của Đại học Bách khoa Hà Nội
                        if (isHUSTMethod && (methodLower.includes('thpt') || methodLower.includes('tsa') || methodLower.includes('đgtd') || methodLower.includes('dgtd'))) {
                            // Ưu tiên điểm từ kết quả quy đổi
                            if (methodLower.includes('tsa') || methodLower.includes('đgtd') || methodLower.includes('dgtd')) {
                                // Phương thức TSA - luôn sử dụng điểm output (đã cộng ưu tiên)
                                suggestMethod = 'TSA';
                                benchmarkField = 'diem_tsa_2024';
                                suggestScore = finalScore; // Luôn sử dụng điểm output
                            } else if (methodLower.includes('thpt')) {
                                // Phương thức THPT - luôn sử dụng điểm output (đã cộng ưu tiên)
                                suggestMethod = 'THPT';
                                benchmarkField = 'diem_thpt_2024';
                                suggestScore = finalScore; // Luôn sử dụng điểm output
                            }
                        }

                        if (!isNaN(suggestScore) && benchmarkField) {
                            let suggestedMajors;

                            if (suggestMethod === 'TSA') {
                                // Với TSA: hiển thị tất cả ngành (không lọc)
                                suggestedMajors = benchmarkData
                                    .sort((a, b) => b[benchmarkField] - a[benchmarkField]);
                            } else {
                                // Với THPT: chỉ hiển thị ngành có cơ hội (như cũ)
                                suggestedMajors = benchmarkData
                                    .filter(item => (suggestScore - item[benchmarkField]) >= -0.4)
                                    .sort((a, b) => b[benchmarkField] - a[benchmarkField]);
                            }
                            if (suggestedMajors.length > 0) {
                                html += `
                                    <div class="benchmark-card mt-4">
                                        <div class="benchmark-title">
                                            <i class="fas fa-lightbulb me-2"></i>Gợi ý ngành phù hợp với điểm của bạn (Số liệu điểm chuẩn năm 2024)
                                        </div>
                                        <div class="result-summary">
                                            <p><i class="fas fa-info-circle me-2"></i>Với điểm ${suggestMethod} <b>${suggestScore}</b>, bạn có thể xét tuyển vào các ngành sau của Đại học Bách Khoa Hà Nội:</p>
                                        </div>
                                        <div class="table-responsive">
                                            <table class="benchmark-table">
                                                <thead>
                                                    <tr>
                                                        <th>Ngành</th>
                                                        <th>Mã ngành</th>
                                                        <th>Điểm chuẩn ${suggestMethod} 2024</th>
                                                        <th>Điểm của bạn</th>
                                                        <th>Đánh giá</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                `;
                                suggestedMajors.forEach(item => {
                                    const status = getAdmissionStatus(suggestScore, item[benchmarkField], suggestMethod);
                                    html += `
                                        <tr>
                                            <td>${item.major}</td>
                                            <td>${item.code}</td>
                                            <td>${item[benchmarkField]}</td>
                                            <td>${suggestScore}</td>
                                            <td><span class="score-status ${status.class}">${status.text}</span></td>
                                        </tr>
                                    `;
                                });
                                html += `
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="text-center mt-3">
                                            <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#fullBenchmarkModal">
                                                <i class="fas fa-table me-2"></i>Xem bảng điểm chuẩn đầy đủ các năm
                                            </button>
                                        </div>
                                    </div>
                                `;
                            } else {
                                html += `
                                    <div class="benchmark-card mt-4">
                                        <div class="benchmark-title">
                                            <i class="fas fa-lightbulb me-2"></i>Gợi ý ngành phù hợp với điểm ${suggestMethod} 2024 của bạn
                                        </div>
                                        <div class="result-summary">
                                            <p><i class="fas fa-info-circle me-2"></i>Rất tiếc, hiện không có ngành nào phù hợp với điểm ${suggestMethod} của bạn.</p>
                                        </div>
                                        <div class="text-center mt-3">
                                            <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#fullBenchmarkModal">
                                                <i class="fas fa-table me-2"></i>Xem bảng điểm chuẩn đầy đủ các năm
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }

                            // Thêm nút xem bảng điểm chuẩn đầy đủ cho trường hợp Bách khoa Hà Nội
                            if (isHUSTMethod) {
                                html += `
                                    <div class="benchmark-card mt-4">
                                        <div class="benchmark-title">
                                            <i class="fas fa-chart-bar me-2"></i>Bảng điểm chuẩn tham khảo
                                        </div>
                                        <div class="result-summary">
                                            <p><i class="fas fa-info-circle me-2"></i>Xem bảng điểm chuẩn đầy đủ các ngành của Đại học Bách Khoa Hà Nội qua các năm để tham khảo.</p>
                                        </div>
                                        <div class="text-center">
                                            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#fullBenchmarkModal">
                                                <i class="fas fa-table me-2"></i>Xem bảng điểm chuẩn đầy đủ các năm
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }
                        }

                        resultContent.innerHTML = html;

                // Cập nhật sự kiện in kết quả
                printBtn.onclick = function() {
                    window.print();
                };
            });

            // Xử lý URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const truongParam = urlParams.get('truong');
            const methodParam = urlParams.get('phuongthuc');
            const scoreParam = urlParams.get('diem');

            if (truongParam) {
                truongSelect.value = truongParam;
                truongSelect.dispatchEvent(new Event('change'));
            }

            if (methodParam && phuongthucSelect) {
                for (let option of phuongthucSelect.options) {
                    if (toSlug(option.textContent) === methodParam.toLowerCase()) {
                        phuongthucSelect.value = option.value;
                        break;
                    }
                }
            }

            if (scoreParam) {
                diemInput.value = decodeURIComponent(scoreParam);
            }

            if (truongParam && methodParam && scoreParam) {
                form.dispatchEvent(new Event('submit'));
            }
        });

        // Dữ liệu phân vị TSA Đại học Bách Khoa Hà Nội 2024-2025
        const tsaPercentileData = {
            upper: [
                { percentile: 1, score: 98.61 }, { percentile: 2, score: 78.41 }, { percentile: 3, score: 75.44 },
                { percentile: 4, score: 73.38 }, { percentile: 5, score: 72.01 }, { percentile: 6, score: 70.85 },
                { percentile: 7, score: 69.91 }, { percentile: 8, score: 69.02 }, { percentile: 9, score: 68.31 },
                { percentile: 10, score: 67.64 }, { percentile: 11, score: 67.04 }, { percentile: 12, score: 66.49 },
                { percentile: 13, score: 65.99 }, { percentile: 14, score: 65.52 }, { percentile: 15, score: 65.04 },
                { percentile: 16, score: 64.59 }, { percentile: 17, score: 64.17 }, { percentile: 18, score: 63.78 },
                { percentile: 19, score: 63.39 }, { percentile: 20, score: 63.05 }, { percentile: 21, score: 62.68 },
                { percentile: 22, score: 62.33 }, { percentile: 23, score: 61.98 }, { percentile: 24, score: 61.67 },
                { percentile: 25, score: 61.35 }, { percentile: 26, score: 61.05 }, { percentile: 27, score: 60.75 },
                { percentile: 28, score: 60.45 }, { percentile: 29, score: 60.17 }, { percentile: 30, score: 59.87 },
                { percentile: 31, score: 59.59 }, { percentile: 32, score: 59.33 }, { percentile: 33, score: 59.05 },
                { percentile: 34, score: 58.79 }, { percentile: 35, score: 58.52 }, { percentile: 36, score: 58.24 },
                { percentile: 37, score: 57.98 }, { percentile: 38, score: 57.72 }, { percentile: 39, score: 57.48 },
                { percentile: 40, score: 57.23 }, { percentile: 41, score: 57.00 }, { percentile: 42, score: 56.76 },
                { percentile: 43, score: 56.53 }, { percentile: 44, score: 56.31 }, { percentile: 45, score: 56.06 },
                { percentile: 46, score: 55.81 }, { percentile: 47, score: 55.56 }, { percentile: 48, score: 55.33 },
                { percentile: 49, score: 55.08 }, { percentile: 50, score: 54.85 }, { percentile: 51, score: 54.62 },
                { percentile: 52, score: 54.39 }, { percentile: 53, score: 54.16 }, { percentile: 54, score: 53.91 },
                { percentile: 55, score: 53.68 }, { percentile: 56, score: 53.45 }, { percentile: 57, score: 53.20 },
                { percentile: 58, score: 52.99 }, { percentile: 59, score: 52.75 }, { percentile: 60, score: 52.50 },
                { percentile: 61, score: 52.27 }, { percentile: 62, score: 52.03 }, { percentile: 63, score: 51.79 },
                { percentile: 64, score: 51.53 }, { percentile: 65, score: 51.28 }, { percentile: 66, score: 51.03 },
                { percentile: 67, score: 50.80 }, { percentile: 68, score: 50.55 }, { percentile: 69, score: 50.27 },
                { percentile: 70, score: 50.01 }, { percentile: 71, score: 49.75 }, { percentile: 72, score: 49.47 },
                { percentile: 73, score: 49.18 }, { percentile: 74, score: 48.91 }, { percentile: 75, score: 48.61 },
                { percentile: 76, score: 48.32 }, { percentile: 77, score: 48.00 }, { percentile: 78, score: 47.70 },
                { percentile: 79, score: 47.38 }, { percentile: 80, score: 47.06 }, { percentile: 81, score: 46.73 },
                { percentile: 82, score: 46.38 }, { percentile: 83, score: 46.05 }, { percentile: 84, score: 45.64 },
                { percentile: 85, score: 45.24 }, { percentile: 86, score: 44.83 }, { percentile: 87, score: 44.42 },
                { percentile: 88, score: 43.98 }, { percentile: 89, score: 43.51 }, { percentile: 90, score: 43.00 },
                { percentile: 91, score: 42.48 }, { percentile: 92, score: 41.91 }, { percentile: 93, score: 41.24 },
                { percentile: 94, score: 40.49 }, { percentile: 95, score: 39.70 }, { percentile: 96, score: 38.75 },
                { percentile: 97, score: 37.70 }, { percentile: 98, score: 36.38 }, { percentile: 99, score: 34.36 },
                { percentile: 100, score: 31.51 }
            ],
            lower: [
                { percentile: 1, score: 78.54 }, { percentile: 2, score: 75.59 }, { percentile: 3, score: 73.55 },
                { percentile: 4, score: 72.17 }, { percentile: 5, score: 71.02 }, { percentile: 6, score: 70.06 },
                { percentile: 7, score: 69.21 }, { percentile: 8, score: 68.47 }, { percentile: 9, score: 67.83 },
                { percentile: 10, score: 67.21 }, { percentile: 11, score: 66.66 }, { percentile: 12, score: 66.14 },
                { percentile: 13, score: 65.67 }, { percentile: 14, score: 65.22 }, { percentile: 15, score: 64.79 },
                { percentile: 16, score: 64.35 }, { percentile: 17, score: 63.95 }, { percentile: 18, score: 63.57 },
                { percentile: 19, score: 63.21 }, { percentile: 20, score: 62.84 }, { percentile: 21, score: 62.50 },
                { percentile: 22, score: 62.17 }, { percentile: 23, score: 61.83 }, { percentile: 24, score: 61.53 },
                { percentile: 25, score: 61.23 }, { percentile: 26, score: 60.93 }, { percentile: 27, score: 60.61 },
                { percentile: 28, score: 60.33 }, { percentile: 29, score: 60.06 }, { percentile: 30, score: 59.78 },
                { percentile: 31, score: 59.50 }, { percentile: 32, score: 59.24 }, { percentile: 33, score: 58.97 },
                { percentile: 34, score: 58.70 }, { percentile: 35, score: 58.43 }, { percentile: 36, score: 58.17 },
                { percentile: 37, score: 57.89 }, { percentile: 38, score: 57.65 }, { percentile: 39, score: 57.42 },
                { percentile: 40, score: 57.18 }, { percentile: 41, score: 56.95 }, { percentile: 42, score: 56.71 },
                { percentile: 43, score: 56.48 }, { percentile: 44, score: 56.26 }, { percentile: 45, score: 56.01 },
                { percentile: 46, score: 55.76 }, { percentile: 47, score: 55.51 }, { percentile: 48, score: 55.28 },
                { percentile: 49, score: 55.03 }, { percentile: 50, score: 54.80 }, { percentile: 51, score: 54.57 },
                { percentile: 52, score: 54.34 }, { percentile: 53, score: 54.12 }, { percentile: 54, score: 53.86 },
                { percentile: 55, score: 53.63 }, { percentile: 56, score: 53.40 }, { percentile: 57, score: 53.16 },
                { percentile: 58, score: 52.94 }, { percentile: 59, score: 52.70 }, { percentile: 60, score: 52.46 },
                { percentile: 61, score: 52.23 }, { percentile: 62, score: 51.98 }, { percentile: 63, score: 51.74 },
                { percentile: 64, score: 51.49 }, { percentile: 65, score: 51.23 }, { percentile: 66, score: 50.98 },
                { percentile: 67, score: 50.74 }, { percentile: 68, score: 50.48 }, { percentile: 69, score: 50.21 },
                { percentile: 70, score: 49.95 }, { percentile: 71, score: 49.68 }, { percentile: 72, score: 49.40 },
                { percentile: 73, score: 49.10 }, { percentile: 74, score: 48.82 }, { percentile: 75, score: 48.50 },
                { percentile: 76, score: 48.20 }, { percentile: 77, score: 47.87 }, { percentile: 78, score: 47.55 },
                { percentile: 79, score: 47.25 }, { percentile: 80, score: 46.90 }, { percentile: 81, score: 46.54 },
                { percentile: 82, score: 46.20 }, { percentile: 83, score: 45.83 }, { percentile: 84, score: 45.41 },
                { percentile: 85, score: 45.01 }, { percentile: 86, score: 44.57 }, { percentile: 87, score: 44.16 },
                { percentile: 88, score: 43.67 }, { percentile: 89, score: 43.15 }, { percentile: 90, score: 42.63 },
                { percentile: 91, score: 42.07 }, { percentile: 92, score: 41.41 }, { percentile: 93, score: 40.61 },
                { percentile: 94, score: 39.85 }, { percentile: 95, score: 38.93 }, { percentile: 96, score: 37.86 },
                { percentile: 97, score: 36.52 }, { percentile: 98, score: 34.56 }, { percentile: 99, score: 31.62 },
                { percentile: 100, score: 20.00 }
            ]
        };

        // Hàm tính phân vị TSA
        function calculateTSAPercentile(userScore) {
            console.log('calculateTSAPercentile called with score:', userScore);
            if (!userScore || isNaN(userScore)) {
                console.log('Invalid score, returning null');
                return null;
            }

            // Hàm tìm phân vị chính xác
            function findPercentile(data, score, isUpperTable = false) {
                // Nếu điểm cao hơn điểm cao nhất
                if (score > data[0].score) {
                    return 0; // Trả về 0% cho điểm cao hơn mức cao nhất
                }

                // Nếu điểm thấp hơn điểm thấp nhất
                if (score < data[data.length - 1].score) {
                    return 100;
                }

                // Tìm vị trí chính xác
                for (let i = 0; i < data.length - 1; i++) {
                    const current = data[i];
                    const next = data[i + 1];

                    // Nếu điểm bằng chính xác một mức nào đó
                    if (score === current.score) {
                        return current.percentile;
                    }

                    // Nếu điểm nằm giữa hai mức
                    if (score < current.score && score > next.score) {
                        // Trả về phân vị của mức cao hơn (thận trọng hơn)
                        return current.percentile;
                    }
                }

                // Nếu bằng điểm cuối cùng
                if (score === data[data.length - 1].score) {
                    return data[data.length - 1].percentile;
                }

                return 100; // Fallback
            }

            let upperPercentile = findPercentile(tsaPercentileData.upper, userScore, true);
            let lowerPercentile = findPercentile(tsaPercentileData.lower, userScore, false);

            // Xử lý trường hợp đặc biệt cho điểm rất cao
            if (upperPercentile === 0 || lowerPercentile === 0) {
                // Nếu có phân vị 0%, đặt khoảng là 0-1%
                upperPercentile = 1;
                lowerPercentile = 0;
            } else {
                // Đảm bảo luôn có sự khác biệt ít nhất 1 đơn vị
                if (upperPercentile === lowerPercentile) {
                    // Nếu cả hai bằng nhau, điều chỉnh để có sự khác biệt
                    if (upperPercentile > 1) {
                        lowerPercentile = upperPercentile - 1;
                    } else {
                        upperPercentile = lowerPercentile + 1;
                    }
                }
            }

            const result = {
                score: userScore,
                upper: Math.max(upperPercentile, lowerPercentile),  // Phân vị thận trọng (cao hơn)
                lower: Math.min(upperPercentile, lowerPercentile)   // Phân vị tốt nhất (thấp hơn)
            };

            console.log('calculateTSAPercentile result:', result);
            console.log('Upper table percentile:', upperPercentile);
            console.log('Lower table percentile:', lowerPercentile);
            return result;
        }

        // Add the benchmark data and functions
        const benchmarkData = [
            { major: "Kỹ thuật Sinh học", code: "BF1", diem_thpt_2024: 24.00, diem_tsa_2024: 50.29, diem_thpt_2023: 24.60, diem_tsa_2023: 50.29 },
            { major: "Kỹ thuật Thực phẩm", code: "BF2", diem_thpt_2024: 24.54, diem_tsa_2024: 50.29, diem_thpt_2023: 24.49, diem_tsa_2023: 50.29 },
            { major: "Kỹ thuật Thực phẩm (CT tiên tiến)", code: "BF-E12", diem_thpt_2024: 22.00, diem_tsa_2024: 52.55, diem_thpt_2023: 22.70, diem_tsa_2023: 52.55 },
            { major: "Kỹ thuật sinh học (CT tiên tiến)", code: "BF-E19", diem_thpt_2024: 22.00, diem_tsa_2024: 50.29, diem_thpt_2023: 21.00, diem_tsa_2023: 50.29 },
            { major: "Kỹ thuật Hóa học", code: "CH1", diem_thpt_2024: 24.38, diem_tsa_2024: 51.85, diem_thpt_2023: 23.70, diem_tsa_2023: 51.85 },
            { major: "Hóa học", code: "CH2", diem_thpt_2024: 23.81, diem_tsa_2024: 50.29, diem_thpt_2023: 23.04, diem_tsa_2023: 50.29 },
            { major: "Công nghệ Giáo dục", code: "ED2", diem_thpt_2024: 25.30, diem_tsa_2024: 52.07, diem_thpt_2023: 24.55, diem_tsa_2023: 52.07 },
            { major: "Quản lý giáo dục", code: "ED3", diem_thpt_2024: 24.78, diem_tsa_2024: 50.29, diem_thpt_2023: 0, diem_tsa_2023: 0 },
            { major: "Kỹ thuật điện", code: "EE1", diem_thpt_2024: 26.81, diem_tsa_2024: 65.25, diem_thpt_2023: 25.55, diem_tsa_2023: 65.25 },
            { major: "Kỹ thuật điều khiển & Tự động hóa", code: "EE2", diem_thpt_2024: 28.16, diem_tsa_2024: 73.77, diem_thpt_2023: 27.57, diem_tsa_2023: 73.77 },
            { major: "Hệ thống điện và năng lượng tái tạo (CT tiên tiến)", code: "EE-E18", diem_thpt_2024: 25.80, diem_tsa_2024: 58.18, diem_thpt_2023: 24.47, diem_tsa_2023: 58.18 },
            { major: "Kỹ thuật Điều khiển - Tự động hoá (CT tiên tiến)", code: "EE-E8", diem_thpt_2024: 27.54, diem_tsa_2024: 69.13, diem_thpt_2023: 26.74, diem_tsa_2023: 69.13 },
            { major: "Tin học công nghiệp và Tự động hóa (CT Việt - Pháp PFIEV)", code: "EE-EP", diem_thpt_2024: 26.22, diem_tsa_2024: 62.48, diem_thpt_2023: 25.14, diem_tsa_2023: 62.48 },
            { major: "Quản lý Năng lượng", code: "EM1", diem_thpt_2024: 25.40, diem_tsa_2024: 52.68, diem_thpt_2023: 24.98, diem_tsa_2023: 52.68 },
            { major: "Quản lý Công nghiệp", code: "EM2", diem_thpt_2024: 25.60, diem_tsa_2024: 52.68, diem_thpt_2023: 25.39, diem_tsa_2023: 52.68 },
            { major: "Quản trị Kinh doanh", code: "EM3", diem_thpt_2024: 25.77, diem_tsa_2024: 55.65, diem_thpt_2023: 25.83, diem_tsa_2023: 55.65 },
            { major: "Kế toán", code: "EM4", diem_thpt_2024: 25.80, diem_tsa_2024: 54.62, diem_thpt_2023: 25.52, diem_tsa_2023: 54.62 },
            { major: "Tài chính-Ngân hàng", code: "EM5", diem_thpt_2024: 25.91, diem_tsa_2024: 56.17, diem_thpt_2023: 25.75, diem_tsa_2023: 56.17 },
            { major: "Phân tích kinh doanh (CT tiên tiến)", code: "EM-E13", diem_thpt_2024: 25.50, diem_tsa_2024: 53.81, diem_thpt_2023: 25.47, diem_tsa_2023: 53.81 },
            { major: "Logistics và Quản lý chuỗi cung ứng (CT tiên tiến)", code: "EM-E14", diem_thpt_2024: 26.06, diem_tsa_2024: 55.92, diem_thpt_2023: 25.69, diem_tsa_2023: 55.92 },
            { major: "Kỹ thuật Điện tử-Viễn thông", code: "ET1", diem_thpt_2024: 27.41, diem_tsa_2024: 68.88, diem_thpt_2023: 26.46, diem_tsa_2023: 68.88 },
            { major: "Kỹ thuật Y sinh", code: "ET2", diem_thpt_2024: 25.80, diem_tsa_2024: 59.98, diem_thpt_2023: 25.04, diem_tsa_2023: 59.98 },
            { major: "Truyền thông số và Kỹ thuật đa phương tiện (CT tiên tiến)", code: "ET-E16", diem_thpt_2024: 26.61, diem_tsa_2024: 64.98, diem_thpt_2023: 25.73, diem_tsa_2023: 64.98 },
            { major: "Kỹ thuật Điện tử - Viễn thông (CT tiên tiến)", code: "ET-E4", diem_thpt_2024: 27.03, diem_tsa_2024: 65.00, diem_thpt_2023: 25.99, diem_tsa_2023: 65.00 },
            { major: "Kỹ thuật Y sinh (CT tiên tiến)", code: "ET-E5", diem_thpt_2024: 25.08, diem_tsa_2024: 53.67, diem_thpt_2023: 23.70, diem_tsa_2023: 53.67 },
            { major: "Hệ thống nhúng thông minh và IoT (CT tiên tiến)", code: "ET-E9", diem_thpt_2024: 27.21, diem_tsa_2024: 69.07, diem_thpt_2023: 26.45, diem_tsa_2023: 69.07 },
            { major: "Điện tử - Viễn thông - ĐH Leibniz Hannover (CHLB Đức)", code: "ET-LUH", diem_thpt_2024: 25.65, diem_tsa_2024: 56.68, diem_thpt_2023: 24.30, diem_tsa_2023: 56.68 },
            { major: "Kỹ thuật Môi trường", code: "EV1", diem_thpt_2024: 22.10, diem_tsa_2024: 50.72, diem_thpt_2023: 21.00, diem_tsa_2023: 50.72 },
            { major: "Quản lý Tài nguyên và Môi trường", code: "EV2", diem_thpt_2024: 21.78, diem_tsa_2024: 50.33, diem_thpt_2023: 21.00, diem_tsa_2023: 50.33 },
            { major: "Tiếng Anh KHKT và Công nghệ", code: "FL1", diem_thpt_2024: 25.00, diem_tsa_2024: 52.01, diem_thpt_2023: 25.45, diem_tsa_2023: 52.01 },
            { major: "Tiếng Anh chuyên nghiệp quốc tế", code: "FL2", diem_thpt_2024: 23.81, diem_tsa_2024: 50.29, diem_thpt_2023: 25.17, diem_tsa_2023: 50.29 },
            { major: "Kỹ thuật Nhiệt", code: "HE1", diem_thpt_2024: 25.20, diem_tsa_2024: 56.67, diem_thpt_2023: 23.94, diem_tsa_2023: 56.67 },
            { major: "CNTT: Khoa học Máy tính", code: "IT1", diem_thpt_2024: 28.53, diem_tsa_2024: 83.82, diem_thpt_2023: 29.42, diem_tsa_2023: 83.82 },
            { major: "CNTT: Kỹ thuật Máy tính", code: "IT2", diem_thpt_2024: 28.48, diem_tsa_2024: 82.08, diem_thpt_2023: 28.29, diem_tsa_2023: 82.08 },
            { major: "Khoa học dữ liệu và Trí tuệ nhân tạo (CT tiên tiến)", code: "IT-E10", diem_thpt_2024: 28.22, diem_tsa_2024: 81.60, diem_thpt_2023: 28.80, diem_tsa_2023: 81.60 },
            { major: "An toàn không gian số - Cyber security (CT tiên tiến)", code: "IT-E15", diem_thpt_2024: 27.90, diem_tsa_2024: 74.88, diem_thpt_2023: 28.05, diem_tsa_2023: 74.88 },
            { major: "Công nghệ Thông tin Việt – Nhật (CT tiên tiến)", code: "IT-E6", diem_thpt_2024: 27.35, diem_tsa_2024: 71.05, diem_thpt_2023: 27.64, diem_tsa_2023: 71.05 },
            { major: "Công nghệ Thông tin Global ICT (CT tiên tiến)", code: "IT-E7", diem_thpt_2024: 28.01, diem_tsa_2024: 74.88, diem_thpt_2023: 28.16, diem_tsa_2023: 74.88 },
            { major: "Công nghệ Thông tin Việt-Pháp (CT tiên tiến)", code: "IT-EP", diem_thpt_2024: 27.35, diem_tsa_2024: 70.66, diem_thpt_2023: 27.32, diem_tsa_2023: 70.66 },
            { major: "Kỹ thuật Cơ điện tử", code: "ME1", diem_thpt_2024: 27.49, diem_tsa_2024: 68.02, diem_thpt_2023: 26.75, diem_tsa_2023: 68.02 },
            { major: "Kỹ thuật Cơ khí", code: "ME2", diem_thpt_2024: 25.80, diem_tsa_2024: 61.36, diem_thpt_2023: 24.96, diem_tsa_2023: 61.36 },
            { major: "Kỹ thuật Cơ điện tử (CT tiên tiến)", code: "ME-E1", diem_thpt_2024: 26.38, diem_tsa_2024: 61.36, diem_thpt_2023: 25.47, diem_tsa_2023: 61.36 },
            { major: "Cơ khí Chế tạo máy – hợp tác với trường ĐH Griffith (Úc)", code: "ME-GU", diem_thpt_2024: 24.89, diem_tsa_2024: 56.19, diem_thpt_2023: 23.32, diem_tsa_2023: 56.19 },
            { major: "Cơ điện tử - hợp tác với ĐH Leibniz Hannover (CHLB Đức)", code: "ME-LUH", diem_thpt_2024: 25.24, diem_tsa_2024: 56.53, diem_thpt_2023: 24.02, diem_tsa_2023: 56.53 },
            { major: "Cơ điện tử - hợp tác với ĐHCN Nagaoka (Nhật Bản)", code: "ME-NUT", diem_thpt_2024: 25.11, diem_tsa_2024: 56.19, diem_thpt_2023: 23.85, diem_tsa_2023: 56.19 },
            { major: "Toán-Tin", code: "MI1", diem_thpt_2024: 27.35, diem_tsa_2024: 70.60, diem_thpt_2023: 27.21, diem_tsa_2023: 70.60 },
            { major: "Hệ thống Thông tin quản lý", code: "MI2", diem_thpt_2024: 27.34, diem_tsa_2024: 68.45, diem_thpt_2023: 27.06, diem_tsa_2023: 68.45 },
            { major: "Kỹ thuật Vật liệu", code: "MS1", diem_thpt_2024: 24.90, diem_tsa_2024: 56.55, diem_thpt_2023: 23.25, diem_tsa_2023: 56.55 },
            { major: "Kỹ thuật Vi điện tử và Công nghệ nano", code: "MS2", diem_thpt_2024: 27.64, diem_tsa_2024: 71.68, diem_thpt_2023: 26.18, diem_tsa_2023: 71.68 },
            { major: "Công nghệ vật liệu Polyme và Compozit", code: "MS3", diem_thpt_2024: 25.00, diem_tsa_2024: 56.55, diem_thpt_2023: 23.70, diem_tsa_2023: 56.55 },
            { major: "Khoa học và Kỹ thuật Vật liệu (CT tiên tiến)", code: "MS-E3", diem_thpt_2024: 24.00, diem_tsa_2024: 52.53, diem_thpt_2023: 21.50, diem_tsa_2023: 52.53 },
            { major: "Kỹ thuật In", code: "MS5", diem_thpt_2024: 24.00, diem_tsa_2024: 53.42, diem_thpt_2023: 22.70, diem_tsa_2023: 53.42 },
            { major: "Vật lý Kỹ thuật", code: "PH1", diem_thpt_2024: 25.87, diem_tsa_2024: 56.66, diem_thpt_2023: 24.28, diem_tsa_2023: 56.66 },
            { major: "Kỹ thuật Hạt nhân", code: "PH2", diem_thpt_2024: 24.64, diem_tsa_2024: 53.28, diem_thpt_2023: 22.31, diem_tsa_2023: 53.28 },
            { major: "Vật lý Y khoa", code: "PH3", diem_thpt_2024: 25.31, diem_tsa_2024: 55.28, diem_thpt_2023: 24.02, diem_tsa_2023: 55.28 },
            { major: "Kỹ thuật Ô tô", code: "TE1", diem_thpt_2024: 26.99, diem_tsa_2024: 64.36, diem_thpt_2023: 26.48, diem_tsa_2023: 64.36 },
            { major: "Kỹ thuật Cơ khí động lực", code: "TE2", diem_thpt_2024: 26.12, diem_tsa_2024: 59.89, diem_thpt_2023: 25.31, diem_tsa_2023: 59.89 },
            { major: "Kỹ thuật Hàng không", code: "TE3", diem_thpt_2024: 26.22, diem_tsa_2024: 62.36, diem_thpt_2023: 25.50, diem_tsa_2023: 62.36 },
            { major: "Kỹ thuật Ô tô (CT tiên tiến)", code: "TE-E2", diem_thpt_2024: 25.90, diem_tsa_2024: 60.68, diem_thpt_2023: 25.00, diem_tsa_2023: 60.68 },
            { major: "Cơ khí hàng không (CT Việt - Pháp PFIEV)", code: "TE-EP", diem_thpt_2024: 24.86, diem_tsa_2024: 54.68, diem_thpt_2023: 23.70, diem_tsa_2023: 54.68 },
            { major: "Quản trị Kinh doanh - ĐH Troy (Hoa Kỳ)", code: "TROY-BA", diem_thpt_2024: 21.00, diem_tsa_2024: 50.29, diem_thpt_2023: 23.70, diem_tsa_2023: 50.29 },
            { major: "Khoa học Máy tính - ĐH Troy (Hoa Kỳ)", code: "TROY-IT", diem_thpt_2024: 21.00, diem_tsa_2024: 50.29, diem_thpt_2023: 24.96, diem_tsa_2023: 50.29 },
            { major: "Công nghệ Dệt May", code: "TX1", diem_thpt_2024: 22.50, diem_tsa_2024: 50.68, diem_thpt_2023: 21.40, diem_tsa_2023: 50.68 }
        ];

        function getAdmissionStatus(userScore, benchmarkScore, scoreType = 'THPT') {
            const diff = userScore - benchmarkScore;

            if (scoreType === 'TSA') {
                // Thang đánh giá cho TSA (thang 100 điểm)
                if (diff > 5) return { class: 'very-safe', text: 'Rất an toàn' };
                if (diff >= 1.5) return { class: 'safe', text: 'An toàn' };
                if (diff >= 0 && diff < 1.5) return { class: 'risky', text: 'Có cơ hội' };
                if (diff >= -2) return { class: 'risky', text: 'Có cơ hội' };
                return { class: 'low', text: 'Cơ hội thấp' }; // kém từ 2-3 điểm trở xuống
            } else {
                // Thang đánh giá cho THPT (giữ nguyên như cũ)
                if (diff >= 1.5) return { class: 'very-safe', text: 'Rất an toàn' };
                if (diff >= 0.8) return { class: 'safe', text: 'An toàn' };
                if (diff >= -0.1) return { class: 'risky', text: 'Có cơ hội' };
                return { class: 'low', text: 'Cơ hội thấp' };
            }
        }

        function updateBenchmarkTable(userScore, searchTerm = '', scoreType = 'THPT') {
            const tbody = document.getElementById('benchmarkTableBody');
            if (!tbody) return; // Kiểm tra element tồn tại

            tbody.innerHTML = '';

            const filteredData = benchmarkData.filter(item =>
                item.major.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.code.toLowerCase().includes(searchTerm.toLowerCase())
            );

            const benchmarkField = scoreType === 'TSA' ? 'diem_tsa_2024' : 'diem_thpt_2024';

            filteredData.forEach(item => {
                const status = getAdmissionStatus(userScore, item[benchmarkField], scoreType);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.major}</td>
                    <td>${item.code}</td>
                    <td>${item[benchmarkField]}</td>
                    <td>${userScore}</td>
                    <td><span class="score-status ${status.class}">${status.text}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Add search functionality (chỉ khi element tồn tại)
        const majorSearchElement = document.getElementById('majorSearch');
        if (majorSearchElement) {
            majorSearchElement.addEventListener('input', function(e) {
                const userScore = parseFloat(diemInput.value);
                if (!isNaN(userScore)) {
                    updateBenchmarkTable(userScore, e.target.value);
                }
            });
        }

        // Hàm tạo bảng phân vị đầy đủ
        function generatePercentileTable() {
            const tbody = document.getElementById('percentileTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            // Tạo dữ liệu cho từng phân vị từ 1% đến 100%
            for (let percentile = 1; percentile <= 100; percentile++) {
                const upperData = tsaPercentileData.upper.find(item => item.percentile === percentile);
                const lowerData = tsaPercentileData.lower.find(item => item.percentile === percentile);

                const upperScore = upperData ? upperData.score : 'N/A';
                const lowerScore = lowerData ? lowerData.score : 'N/A';

                let meaning = '';
                if (percentile <= 5) {
                    meaning = 'Xuất sắc';
                } else if (percentile <= 15) {
                    meaning = 'Rất tốt';
                } else if (percentile <= 30) {
                    meaning = 'Tốt';
                } else if (percentile <= 50) {
                    meaning = 'Khá';
                } else if (percentile <= 70) {
                    meaning = 'Trung bình';
                } else {
                    meaning = 'Cần cải thiện';
                }

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="fw-bold">Top ${percentile}%</td>
                    <td>${upperScore}</td>
                    <td>${lowerScore}</td>
                    <td><span class="badge ${getPercentileBadgeClass(percentile)}">${meaning}</span></td>
                `;
                tbody.appendChild(row);
            }
        }

        // Hàm lấy class badge cho phân vị
        function getPercentileBadgeClass(percentile) {
            if (percentile <= 5) return 'bg-success';
            if (percentile <= 15) return 'bg-primary';
            if (percentile <= 30) return 'bg-info';
            if (percentile <= 50) return 'bg-warning';
            if (percentile <= 70) return 'bg-secondary';
            return 'bg-danger';
        }

        // Hàm xuất Excel
        function exportPercentileTable() {
            // Tạo dữ liệu cho Excel
            const excelData = [];

            // Thêm header
            excelData.push(['Phân vị (%)', 'Mức điểm cận trên', 'Mức điểm cận dưới', 'Ý nghĩa']);

            // Thêm dữ liệu cho từng phân vị
            for (let percentile = 1; percentile <= 100; percentile++) {
                const upperData = tsaPercentileData.upper.find(item => item.percentile === percentile);
                const lowerData = tsaPercentileData.lower.find(item => item.percentile === percentile);

                const upperScore = upperData ? upperData.score : 'N/A';
                const lowerScore = lowerData ? lowerData.score : 'N/A';

                let meaning = '';
                if (percentile <= 5) meaning = 'Xuất sắc';
                else if (percentile <= 15) meaning = 'Rất tốt';
                else if (percentile <= 30) meaning = 'Tốt';
                else if (percentile <= 50) meaning = 'Khá';
                else if (percentile <= 70) meaning = 'Trung bình';
                else meaning = 'Cần cải thiện';

                excelData.push([`Top ${percentile}%`, upperScore, lowerScore, meaning]);
            }

            // Tạo workbook và worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(excelData);

            // Định dạng cột
            const colWidths = [
                { wch: 15 }, // Phân vị (%)
                { wch: 20 }, // Mức điểm cận trên
                { wch: 20 }, // Mức điểm cận dưới
                { wch: 15 }  // Ý nghĩa
            ];
            ws['!cols'] = colWidths;

            // Định dạng header
            const headerStyle = {
                font: { bold: true, color: { rgb: "FFFFFF" } },
                fill: { fgColor: { rgb: "366092" } },
                alignment: { horizontal: "center", vertical: "center" }
            };

            // Áp dụng style cho header (dòng đầu tiên)
            ['A1', 'B1', 'C1', 'D1'].forEach(cell => {
                if (ws[cell]) {
                    ws[cell].s = headerStyle;
                }
            });

            // Thêm worksheet vào workbook
            XLSX.utils.book_append_sheet(wb, ws, "Bảng Phân Vị TSA 2024");

            // Xuất file Excel
            XLSX.writeFile(wb, "Bang_Phan_Vi_TSA_2024.xlsx");
        }

        // Hàm tạo bảng điểm chuẩn đầy đủ
        function generateFullBenchmarkTable(searchTerm = '') {
            const tbody = document.getElementById('fullBenchmarkTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            const filteredData = benchmarkData.filter(item =>
                item.major.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.code.toLowerCase().includes(searchTerm.toLowerCase())
            );

            filteredData.forEach(item => {
                // Tính xu hướng THPT
                const thptTrend = item.diem_thpt_2023 === 0 ? 'N/A' :
                    (item.diem_thpt_2024 > item.diem_thpt_2023 ? '↗️ Tăng' :
                     item.diem_thpt_2024 < item.diem_thpt_2023 ? '↘️ Giảm' : '➡️ Ổn định');

                // Tính xu hướng TSA
                const tsaTrend = item.diem_tsa_2023 === 0 ? 'N/A' :
                    (item.diem_tsa_2024 > item.diem_tsa_2023 ? '↗️ Tăng' :
                     item.diem_tsa_2024 < item.diem_tsa_2023 ? '↘️ Giảm' : '➡️ Ổn định');

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.major}</td>
                    <td>${item.code}</td>
                    <td>${item.diem_thpt_2024}</td>
                    <td>${item.diem_thpt_2023 === 0 ? 'N/A' : item.diem_thpt_2023}</td>
                    <td>${item.diem_tsa_2024}</td>
                    <td>${item.diem_tsa_2023 === 0 ? 'N/A' : item.diem_tsa_2023}</td>
                    <td>${thptTrend}</td>
                    <td>${tsaTrend}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Hàm xuất Excel cho bảng điểm chuẩn đầy đủ
        function exportFullBenchmarkTable() {
            const excelData = [];

            // Thêm header
            excelData.push(['Ngành', 'Mã ngành', 'THPT 2024', 'THPT 2023', 'TSA 2024', 'TSA 2023', 'Xu hướng THPT', 'Xu hướng TSA']);

            // Thêm dữ liệu
            benchmarkData.forEach(item => {
                const thptTrend = item.diem_thpt_2023 === 0 ? 'N/A' :
                    (item.diem_thpt_2024 > item.diem_thpt_2023 ? 'Tăng' :
                     item.diem_thpt_2024 < item.diem_thpt_2023 ? 'Giảm' : 'Ổn định');

                const tsaTrend = item.diem_tsa_2023 === 0 ? 'N/A' :
                    (item.diem_tsa_2024 > item.diem_tsa_2023 ? 'Tăng' :
                     item.diem_tsa_2024 < item.diem_tsa_2023 ? 'Giảm' : 'Ổn định');

                excelData.push([
                    item.major,
                    item.code,
                    item.diem_thpt_2024,
                    item.diem_thpt_2023 === 0 ? 'N/A' : item.diem_thpt_2023,
                    item.diem_tsa_2024,
                    item.diem_tsa_2023 === 0 ? 'N/A' : item.diem_tsa_2023,
                    thptTrend,
                    tsaTrend
                ]);
            });

            // Tạo workbook và worksheet
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Điểm chuẩn HUST 2023-2024");

            // Xuất file Excel
            XLSX.writeFile(wb, "Diem_Chuan_HUST_2023_2024.xlsx");
        }

        // Khởi tạo bảng phân vị khi modal được mở
        document.getElementById('percentileTableModal').addEventListener('shown.bs.modal', function () {
            generatePercentileTable();
        });

        // Khởi tạo bảng điểm chuẩn đầy đủ khi modal được mở
        document.getElementById('fullBenchmarkModal').addEventListener('shown.bs.modal', function () {
            generateFullBenchmarkTable();
        });

        // Thêm tìm kiếm cho bảng điểm chuẩn đầy đủ
        const fullBenchmarkSearchElement = document.getElementById('fullBenchmarkSearch');
        if (fullBenchmarkSearchElement) {
            fullBenchmarkSearchElement.addEventListener('input', function(e) {
                generateFullBenchmarkTable(e.target.value);
            });
        }

        // Dữ liệu khu vực ưu tiên (mẫu - sẽ được mở rộng)
        const regionData = [

            {code: "1", province: "Hà Nội", region: "KV1", details: "Gồm: 7 xã: Ba Trại, Ba Vì, Khánh Thượng, Minh Quang, Tản Lĩnh, Vân Hòa, Yên Bài (thuộc huyện Ba Vì); 3 xã: Tiến Xuân, Yên Bình, Yên Trung (thuộc huyện Thạch Thất); 2 xã: Đông Xuân, Phú Mãn (thuộc huyện Quốc Oai); 1 xã: Trần Phú (thuộc huyện Chương Mỹ); 1 xã: An Phú (thuộc huyện Mỹ Đức)."},

            {code: "1", province: "Hà Nội", region: "KV2", details: "Gồm: Thị xã Sơn Tây; huyện: Thanh Trì, Gia Lâm, Đông Anh, Sóc Sơn, Ba Vì, Phúc Thọ, Thạch Thất, Quốc Oai, Chương Mỹ, Đan Phượng, Hoài Đức, Thanh Oai, Mỹ Đức, Ứng Hoà, Thường Tín, Phú Xuyên, Mê Linh. (Trừ một số xã ở khu vực 1 thuộc KV1 của 5 huyện: Ba Vì, Thạch Thất, Quốc Oai, Chương Mỹ, Mỹ Đức đã ghi ở trên)."},
            {code: "1", province: "Hà Nội", region: "KV3", details: "Gồm các quận: Ba Đình, Hoàn Kiếm, Hai Bà Trưng, Đống Đa, Tây Hồ, Cầu Giấy, Thanh Xuân, Hoàng Mai, Long Biên, Bắc Từ Liêm, Hà Đông, Nam Từ Liêm."},

            {code: "2", province: "TP. HCM", region: "KV2", details: "Gồm các huyện: Bình Chánh, Cần Giờ, Củ Chi, Hóc Môn, Nhà Bè"},
            {code: "2", province: "TP. HCM", region: "KV3", details: "Gồm các quận: 1, 2, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, Bình Thạnh, Gò Vấp, Phú Nhuận, Tân Bình, Thủ Đức, Tân Phú, Bình Tân"},
            {code: "3", province: "Hải phòng", region: "KV1", details: "Huyện Thủy Nguyên gồm các xã: Xã Lại Xuân; Xã Kỳ Sơn; Xã An Sơn; Xã Liên Khê; Xã Lưu Kiếm; Xã Lưu Kỳ; Xã Minh Tân.  Huyện Cát Hải gồm các xã:Thị trấn Cát Bà; Xã Trân Châu; Xã Xuân Đán; Xã Hiền Hào; Xã Gia Luận; Xã Phù Long; Xã Việt Hải, Đồng Bài, Hoàng Châu, Nghĩa Lộ, Văn Phong, Thị Trấn Cát Hải."},

            {code: "3", province: "Hải phòng", region: "KV2", details: "Gồm các huyện: An Lão; Kiến Thụy; Thủy Nguyên (trừ các xã KV1); An Dương; Tiên Lãng; Vĩnh Bảo; Bạch Long Vĩ."},
            {code: "3", province: "Hải phòng", region: "KV3", details: "Gồm các quận: Hồng Bàng; Lê Chân; Ngô Quyền; Kiến An; Hải An; Đồ Sơn; Dương Kinh."},
            {code: "4", province: "Đà Nẵng", region: "KV1", details: "Huyện đảo Hoàng Sa"},
            {code: "4", province: "Đà Nẵng", region: "KV2", details: "Gồm các xã thuộc huyện Hòa Vang"},
            {code: "4", province: "Đà Nẵng", region: "KV3", details: "Gồm các quận: Hải Châu, Thanh Khê, Sơn Trà, Ngũ Hành Sơn, Liên Chiểu, Cẩm Lệ"},
            {code: "5", province: "Hà Giang", region: "KV1", details: "Toàn tỉnh"},
            {code: "6", province: "Cao Bằng", region: "KV1", details: "Toàn tỉnh"},,
            {code: "7", province: "Lai Châu", region: "KV1", details: "Toàn tỉnh"},
            {code: "8", province: "Lào Cai", region: "KV1", details: "Toàn tỉnh"},
            {code: "9", province: "Tuyên Quang", region: "KV1", details: "Toàn tỉnh"},
            {code: "10", province: "Lạng Sơn", region: "KV1", details: "Toàn tỉnh"},
            {code: "11", province: "Bắc Kạn", region: "KV1", details: "Toàn tỉnh"},
            {code: "12", province: "Thái Nguyên", region: "KV1", details: "Gồm các huyện: Võ Nhai, Định Hoá, Đại Từ, Phú Lương, Đồng Hỷ và các xã: Phúc Thuận, Minh Đức, Phúc Tân, Thành Công, Vạn Phái, Tiên Phong và thị trấn Bắc Sơn (thuộc TX Phổ Yên), Tân Thành, Tân Kim, Tân Hoà, Tân Khánh, Tân Đức, Bàn Đạt, Kha Sơn (thuộc huyện Phú Bình), xã Bình Sơn (Thành phố xã Sông Công), Tân Cương, Phúc Trìu, Phúc Xuân, Phúc Hà, Thịnh Đức, Đồng Bẩm, Cao Ngạn, Đồng Liên, Sơn Cẩm, Chùa Hang, Linh Sơn, Huống Thượng (thuộc TP.Thái Nguyên"},

            {code: "12", province: "Thái Nguyên", region: "KV2-NT", details: "Gồm huyện Phú Bình (trừ các xã thuộc KV1)."},
            {code: "12", province: "Thái Nguyên", region: "KV2", details: "Gồm các xã, phường của Thành phố Sông Công, Thành phố Thái Nguyên, Thị xã Phổ Yên (trừ các xã, phường thuộc KV1)."},
            {code: "13", province: "Yên Bái", region: "KV1", details: "Toàn tỉnh"},
            {code: "14", province: "Sơn La", region: "KV1", details: "Toàn tỉnh"},
            {code: "15", province: "Phú Thọ", region: "KV1", details: "Gồm các xã thuộc huyện: Đoan Hùng, Thanh Ba (Trừ các xã: Đỗ Sơn, Đỗ Xuyên, Lương Lỗ, Thanh Hà, Vũ Yển), Hạ Hòa (Trừ các xã Vụ Cầu), Cẩm Khê (Trừ các xã: Phương Xá, Đồng Cam, Sai Nga, Hiền Đa, Cát Trù), Yên Lập, Thanh Sơn, Phù Ninh (Trừ các xã: Bình Bộ, Tử Đà, Vĩnh Phú), Tam Nông (Trừ các xã: Hồng Đà, Tam Cường, Vực Trường), Thanh Thủy (Trừ các xã: Bảo Yên, Đoan Hạ, Đồng Luận, Xuân Lộc), Tân Sơn; xã Chu Hóa, xã Hy Cương, xã Kim Đức, xã Thanh Đình (thuộc thành phố Việt Trì), xã Hà Thạch, xã Phú Hộ (thuộc thị xã Phú Thọ), thị trấn Hùng Sơn, xã Tiên Kiên, xã Xuân Lũng (thuộc huyện Lâm Thao)"},
            {code: "15", province: "Phú Thọ", region: "KV2-NT", details: "Huyện: Thanh Ba, Hạ Hòa, Cẩm Khê, Phù Ninh, Lâm Thao, Tam Nông, Thanh Thủy (Trừ các xã thuộc KV1)"},

            {code: "15", province: "Phú Thọ", region: "KV2", details: "Thành phố Việt Trì, Thị xã Phú Thọ (Trừ các xã thuộc KV1)"},
            {code: "16", province: "Vĩnh Phúc", region: "KV1", details: "Gồm: huyện Tam Đảo; xã Đồng Tĩnh, Hoàng Hoa, Hướng Đạo (thuộc huyện Tam Dương); Xã Bàn Giản, Bắc Bình, Hợp Lý, Liên Hòa, Liễn Sơn, Ngọc Mỹ, Quang Sơn, Tử Du, Thái Hòa, Vân Trục, Xuân Hòa, Xuân Lôi, thị trấn Hoa Sơn, thị trấn Lập Thạch (thuộc huyện Lập Thạch); xã Trung Mỹ (thuộc huyện Bình Xuyên); xã Bạch Lưu, Đôn Nhân, Đồng Quế, Đồng Thịnh, Hải Lựu, Lãng Công, Nhạo Sơn, Nhân Đạo, Phương Khoan, Quang Yên, Tân Lập, Yên Thạch (thuộc huyện Sông Lô); xã Ngọc Thanh (thuộc thành phố Phúc Yên)."},
            {code: "16", province: "Vĩnh Phúc", region: "KV2-NT", details: "Gồm các huyện: Yên Lạc, Vĩnh Tường, Tam Dương, Sông Lô, Lập Thạch, Bình Xuyên (trừ các xã ở KV1 thuộc huyện Tam Dương, Sông Lô, Lập Thạch, Bình Xuyên đã ghi ở trên)."},
            {code: "16", province: "Vĩnh Phúc", region: "KV2", details: "Thành phố Vĩnh Yên, Thành phố Phúc Yên (Trừ xã ở KV1 thuộc"},
            {code: "", province: "", region: "", details: "thành phố Phúc Yên)."},
            {code: "17", province: "Quảng Ninh", region: "KV1", details: "Gồm các huyện: Ba Chẽ, Bình Liêu, Cô Tô; các phường Đại Yên, Hà Khánh, Hà Phong, Hà Trung, Việt Hưng (thuộc Thành phố Hạ Long); các phường Mông Dương, Quang Hanh, các xã Cẩm Hải, Cộng Hòa, Dương Huy (thuộc Thành phố Cẩm Phả); các phường Bắc Sơn, Nam Khê, Phương Đông, Vàng Danh, Yên Thanh, xã Thượng Yên Công (thuộc Thành phố Uông Bí); các phường Hải Hòa, Hải Yên, Ninh Dương, các xã Bắc Sơn, Hải Đông, Hải Sơn, Hải Tiến, Hải Xuân, Quảng Nghĩa, Vĩnh Thực, Vĩnh Trung (thuộc Thành phố Móng Cái); các xã Đại Bình, Đầm Hà, Dực Yên, Quảng An, Quảng Lâm, Quảng Lợi, Quảng Tân, Tân Bình, Tân Lập (thuộc huyện Đầm Hà); các xã Cái Chiên, Đường Hoa, Quảng Đức, Quảng Long, Quảng Phong, Quảng Sơn, Quảng Thành, Quảng Thịnh, Tiến Tới (thuộc huyện Hải Hà); các xã Đại Dực, Đại Thành, Điền Xá, Đông Hải, Đông Ngũ, Đồng Rui, Hà Lâu, Hải Lạng, Phong Dụ, Tiên Lãng, Yên Than (thuộc huyện Tiên Yên); các xã An Sinh, Bình Dương, Bình Khê, Hoàng Quế, Hồng Thái Đông, Hồng Thái Tây, Nguyễn Huệ, Tân Việt, Thủy An, Tràng Lương, Việt Dân, Yên Đức, Yên Thọ, phường Mạo Khê (thuộc Thị xã Đông Triều); các phường Đông Mai, Minh Thành, xã Hoàng Tân (thuộc Thị xã Quảng Yên); các xã Bằng Cả, Dân Chủ, Đồng Lâm, Đồng Sơn, Hòa Bình, Kỳ Thượng, Quảng La, Sơn Dương, Tân Dân, Thống Nhất, Vũ Oai (thuộc huyện Hoành Bồ); các xã Bình Dân, Đài Xuyên, Đoàn Kết, Đông Xá, Minh Châu, Quan Lạn, Thắng Lợi, Vạn Yên (thuộc huyện Vân Đồn)."},
            {code: "17", province: "Quảng Ninh", region: "KV2-NT", details: "Gồm các huyện: Đầm Hà, Hải Hà, Tiên Yên, Hoành Bồ, Vân Đồn (trừ các xã thuộc KV1)"},

            {code: "17", province: "Quảng Ninh", region: "KV2", details: "Gồm các thành phố: Hạ Long, Cẩm Phả, Uông Bí, Móng Cái; các Thị xã Quảng Yên, Đông Triều (trừ các xã, phường thuộc KV1)."},
            {code: "18", province: "Bắc Giang", region: "KV1", details: "Gồm các huyện: Sơn Động; Lục Ngạn; Lục Nam; Yên Thế; Tân Yên; Yên Dũng; các xã An Hà, Đại Lâm, Đào Mỹ, Dương Đức, Hương Lạc, Hương Sơn, Mỹ Hà, Mỹ Thái, Nghĩa Hòa, Nghĩa Hưng, Phi Mô, Quang Thịnh, Tân Dĩnh, Tân Hưng, Tân Thanh, Tân Thịnh, Thái Đào, Tiên Lục, Xuân Hương, Xương Lâm, Yên Mỹ (thuộc huyện Lạng Giang); các xã Danh Thắng, Đồng Tân, Đức Thắng, Hòa Sơn, Hoàng An, Hoàng Thanh, Hoàng Vân, Hùng Sơn, Lương Phong, Ngọc Sơn, Thái Sơn, Thanh Vân, Thường Thắng, Mai Đình, Hương Lâm, Hợp Thịnh,Quang Minh, Mai Trung, Xuân Cẩm, Đại Thành (thuộc huyện Hiệp Hòa); các xã Minh Đức, Nghĩa Trung, Tiên Sơn, Thượng Lan,Trung Sơn, Vân Trung (thuộc huyện Việt Yên); các xã Dĩnh Trì, Đồng Sơn (thuộc TP. Bắc Giang)."},

            {code: "18", province: "Bắc Giang", region: "KV2-NT", details: "Gồm các huyện: Hiệp Hòa; Việt Yên; Lạng Giang (trừ các xã, thị trấn thuộc KV1)"},
            {code: "18", province: "Bắc Giang", region: "KV2", details: "Gồm các xã, phường thuộc TP Bắc Giang (trừ các xã thuộc KV1)"},
            {code: "19", province: "Bắc Ninh", region: "KV2-NT", details: "Gồm các huyện: Yên Phong, Tiên Du, Quế Võ, Thuận Thành, Gia Bình, Lương Tài"},
            {code: "19", province: "Bắc Ninh", region: "KV2", details: "Gồm: Thị xã Từ Sơn, TP. Bắc Ninh"},
            {code: "21", province: "Hải Dương", region: "KV1", details: "Huyện Chí Linh, bao gồm các xã: An Lạc, Bắc An, Cổ Thành, Đồng Lạc, Hoàng Hoa Thám, Hoàng Tiến, Hưng Đạo, Lê Lợi, Nhân Huệ, Tân Dân, Văn Đức, Kênh Giang (Riêng thôn Tân Lập). Huyện Kinh môn, bao gồm các xã: Hiệp An, Phúc Thành, An Phụ, Hiệp Hòa, Thượng Quận, Phạm Mệnh, An Sinh, Thất Hùng, Thái Sơn, Hiệp Sơn, Bạch Đằng, Lê Ninh, Duy Tân, Thị trấn Phú Thứ, Tân Dân, Hoành Sơn; thị trấn Minh Tân, thị trấn Kinh Môn."},
            {code: "21", province: "Hải Dương", region: "KV2-NT", details: "Gồm các huyện của tỉnh (trừ các xã thuộc KV1)"},
            {code: "21", province: "Hải Dương", region: "KV2", details: "Gồm các xã, phường của thành phố Hải Dương, bao gồm các phường, xã: Tân Bình, Thanh Bình, Ngọc Châu, Nhị Châu, Hải Tân, Quang Trung, Bình Hàn, Cẩm Thượng, Phạm Ngũ Lão, Lê Thanh Nghị, Nguyễn Trãi, Trần Phú, Trần Hưng Đạo, Tứ Minh, Việt Hoà, và các xã Nam Đồng, Ái Quốc, An Châu, Thượng Đạt, Thạch Khôi, Tân Hưng. Các phường thuộc thị xã Chí Linh."},
            {code: "22", province: "Hưng Yên", region: "KV2-NT", details: "Gồm các huyện Tiên Lữ, Ân Thi, Phù Cừ, Mỹ Hào, Yên Mỹ, Kim Động, Khoái Châu, Văn Giang, Văn Lâm."},

            {code: "22", province: "Hưng Yên", region: "KV2", details: "Các phường, xã thuộc Thành phố Hưng Yên."},
            {code: "23", province: "Hoà Bình", region: "KV1", details: "Toàn tỉnh"},
            {code: "24", province: "Hà Nam", region: "KV2-NT", details: "Gồm tất cả các huyện: Duy Tiên, Kim Bảng, Lý Nhân, Thanh Liêm, Bình Lục"},
            {code: "24", province: "Hà Nam", region: "KV2", details: "Gồm các xã, phường của thành phố Phủ Lý"},
            {code: "25", province: "Nam Định", region: "KV2-NT", details: "Gồm tất cả các huyện: Mỹ Lộc, Vụ Bản, Ý Yên, Nam Trực, Trực Ninh, Xuân Trường, Giao Thủy, Hải Hậu, Nghĩa Hưng"},

            {code: "25", province: "Nam Định", region: "KV2", details: "Thành phố Nam Định"},
            {code: "26", province: "Thái Bình", region: "KV2-NT", details: "Gồm các huyện: Quỳnh Phụ, Hưng Hà, Đông Hưng, Vũ Thư, Kiến Xương, Tiền Hải, Thái Thụy"},
            {code: "26", province: "Thái Bình", region: "KV2", details: "Thành phố Thái Bình"},
            {code: "27", province: "Ninh Bình", region: "KV1", details: "Toàn bộ các xã, phường của thành phố Tam Điệp; Toàn bộ các xã, thị trấn của huyện Nho Quan; Các xã: Gia Hòa, Gia Hưng, Gia Sinh, Gia Thanh, Gia Vân, Gia Thịnh, Gia Vượng, Gia phương, Gia Minh, Liên Sơn (thuộc huyện Gia Viễn); Các xã: Ninh Hải, Ninh Hòa, Ninh Thắng, Ninh Vân, Ninh Xuân, Trường Yên (thuộc huyện Hoa Lư); Các xã: Khánh Thượng, Mai Sơn, Yên Đồng,Yên Hòa, Yên Lâm, Yên Mạc, Yên Thắng, Yên Thành, Yên Thái (thuộc huyện Yên Mô); Các xã: Cồn Thoi, Kim Tân, Kim Mỹ, Kim Hải, Kim Trung (thuộc huyện Kim Sơn); xã Ninh Nhất (thuộc TP. Ninh Bình)."},
            {code: "27", province: "Ninh Bình", region: "KV2-NT", details: "Huyện Gia Viễn; Huyện Hoa Lư, Huyện Yên Mô, Huyện Kim Sơn, Huyện Yên Khánh. (trừ một số xã ở thuộc KV1 của 4 huyện sau: Gia Viễn, Hoa Lư, Yên Mô, Kim Sơn)."},
            {code: "27", province: "Ninh Bình", region: "KV2", details: "Thành phố Ninh Bình (trừ xã Ninh Nhất)."},
            {code: "28", province: "Thanh Hóa", region: "KV1", details: "Gồm 11 huyện miền núi: Mường Lát, Quan Sơn, Quan Hóa, Lang Chánh, Bá Thước, Cẩm Thủy, Ngọc Lặc, Thường Xuân, Như Xuân, Như Thanh, Thạch Thành; các xã: xã Quảng Phú, Thọ Lâm, Xuân Châu, Xuân Phú, Xuân Thắng (thuộc huyện Thọ Xuân); xã Thọ Sơn, Triệu Thành, Bình Sơn, Thọ Bình (thuộc huyện Triệu Sơn); xã Vĩnh An, Vĩnh Hùng, Vĩnh Hưng, Vĩnh Long, Vĩnh Quang, Vĩnh Thịnh (thuộc huyện Vĩnh Lộc); xã Phú Lâm, Trường Lâm, Phú Sơn, Tân Trường, Tân Dân, Hải Ninh, Hải Thanh, Ninh Hải, Hải Lĩnh, Hải Hòa, Hải Bình, Tĩnh Hải, Hải Yến, Hải Hà, Hải Thượng, Nghi Sơn, Hải An (thuộc huyện Tĩnh Gia); xã Hà Đông, Hà Lĩnh, Hà Long, Hà Sơn, Hà Tân, Hà Tiến (thuộc huyện Hà Trung); xã Yên Lâm (thuộc huyện Yên Định); phường Bắc Sơn (thuộc Thị xã Bỉm Sơn); các xã Hưng Lộc, Ngư Lộc, Đa Lộc, Hải Lộc (thuộc Huyện Hậu Lộc); các xã: Hoằng Châu, Hoằng Hải, Hoằng Thanh, Hoằng Trường, Hoằng Tiến, Hoằng Phụ, Hoằng Yến, (Thuộc Huyện Hoằng Hóa); Quảng Hùng, Quảng Vinh (thuộc Thành phố Sầm Sơn); các xã: Nga Thủy, Nga Tiến, Nga Tân (thuộc huyện Nga Sơn)."},
            {code: "28", province: "Thanh Hóa", region: "KV2-NT", details: "Gồm tất cả các huyện: Vĩnh Lộc, Yên Định, Thiệu Hóa, Đông Sơn,Triệu Sơn, Thọ Xuân, Nông Cống, Tĩnh Gia, Quảng Xương, Hoằng Hóa, Hậu Lộc, Hà Trung, Nga Sơn (trừ một số xã thuộc KV1 của huyện Vĩnh Lộc, Yên Định, Triệu Sơn, Thọ Xuân, Tĩnh Gia, Hà Trung đã ghi ở trên)."},
            {code: "28", province: "Thanh Hóa", region: "KV2", details: "Thành phố Thanh Hóa, Thành phố Sầm Sơn, thị xã Bỉm Sơn (trừ phường Bắc Sơn thuộc KV1 của Thị xã Bỉm Sơn đã ghi ở trên)."},
            {code: "29", province: "Nghệ An", region: "KV1", details: "Gồm toàn bộ các huyện: Kỳ Sơn, Quế Phong, Tương Dương, Con Cuông, Quỳ Châu, Quỳ Hợp, Tân Kỳ, Anh Sơn, Nghĩa Đàn; Các xã: Đông Hiếu, Long Sơn, Nghĩa Hòa, Nghĩa Tiến, Quang Long, Quang Tiến, Tây Hiếu (thuộc thị xã Thái Hòa); Các xã: Cát Văn, Phong Thịnh, Ngọc Sơn, Thanh Dương, Thanh Hòa, Thanh Lĩnh, Thanh Lương, Thanh Ngọc, Thanh Nho, Thanh Phong, Võ Liệt, Xuân Tường, Hạnh Lâm, Thanh Chi, Thanh Đức, Thanh Hà, Thanh Hương, Thanh Khê, Thanh Lâm, Thanh Long, Thanh Tiên, Thanh Thịnh, Thanh Thuỷ, Thanh An, Thanh Mai, Thanh Mỹ, Thanh Tùng, Thanh Xuân, Thanh Liên, Ngọc Lâm, Thanh Sơn, (thuộc huyện Thanh Chương); Các xã: Đồng Thành, Hậu Thành, Hùng Thành, Lăng Thành, Mã Thành, Mỹ Thành, Phúc Thành, Sơn Thành, Đại Thành, Đức Thành, Kim Thành, Lý Thành, Minh Thành, Quang Thành, Tân Thành, Tây Thành, Thịnh Thành, Tiến Thành, (thuộc huyện Yên Thành);"},
            {code: "29", province: "Nghệ An", region: "KV1", details: "Gồm toàn bộ các huyện: Kỳ Sơn, Quế Phong, Tương Dương, Con Cuông, Quỳ Châu, Quỳ Hợp, Tân Kỳ, Anh Sơn, Nghĩa Đàn; Các xã, phường: xã Đông Hiếu, phường Long Sơn, xã Nghĩa Hòa, xã Nghĩa Tiến, phường Quang Long, phường Quang Tiến, xã Tây Hiếu (thuộc thị xã Thái Hòa); Các xã: Cát Văn, Phong Thịnh, Ngọc Sơn, Thanh Dương, Thanh Hòa, Thanh Lĩnh, Thanh Lương, Thanh Ngọc, Thanh Nho, Thanh Phong, Võ Liệt, Xuân Tường, Hạnh Lâm, Thanh Chi, Thanh Đức, Thanh Hà, Thanh Hương, Thanh Khê, Thanh Lâm, Thanh Long, Thanh Tiên, Thanh Thịnh, Thanh Thuỷ, Thanh An, Thanh Mai, Thanh Mỹ, Thanh Tùng, Thanh Xuân, Thanh Liên, Ngọc Lâm, Thanh Sơn, (thuộc huyện Thanh Chương); Các xã: Đồng Thành, Hậu Thành, Hùng Thành, Lăng Thành, Mã Thành, Mỹ Thành, Phúc Thành, Sơn Thành, Đại Thành, Đức Thành, Kim Thành, Lý Thành, Minh Thành, Quang Thành, Tân Thành, Tây Thành, Thịnh Thành, Tiến Thành, (thuộc huyện Yên Thành);"},
            {code: "29", province: "Nghệ An", region: "KV1", details: "Các xã: Bài Sơn, Giang Sơn Đông, Giang Sơn Tây, Hồng Sơn, Lam Sơn, Nam Sơn, Ngọc Sơn (thuộc huyện Đô Lương); Các xã: Diễn Lâm, Diễn Vạn, Diễn Trung, Diễn Bích, Diễn Hải, Diễn Kim (thuộc huyện Diễn Châu); Các xã Nam Hưng, Nam Thái, Nam Tân, Nam Lộc, Nam Thượng (thuộc huyện Nam Đàn); Các xã Nghi Hưng, Nghi Văn, Nghi Kiều, Nghi Công Bắc, Nghi Công Nam, Nghi Lâm, Nghi Yên, Nghi Tiến, Nghi Thiết, Nghi Quang (thuộc huyện Nghi Lộc); Các xã: Ngọc Sơn, Quỳnh Châu, Quỳnh Hoa, Quỳnh Tam, Tân Sơn, Quỳnh Thắng, Quỳnh Tân, Tân Thắng, Quỳnh Thọ, Quỳnh Long (thuộc huyện Quỳnh Lưu); Xã Quỳnh Lộc, Quỳnh Trang (thuộc TX Hoàng Mai)."},
            {code: "29", province: "Nghệ An", region: "KV2-NT", details: "Gồm các huyện: Yên Thành, Diễn Châu, Quỳnh Lưu, Nghi Lộc, Nam Đàn, Hưng Nguyên, Đô Lương, Thanh Chương (trừ các xã thuộc KV1)"},
            {code: "29", province: "Nghệ An", region: "KV2", details: "Gồm các phường, xã thuộc thành phố Vinh và Thị xã Cửa Lò; thị xã Thái Hòa (trừ các xã, phường có tên trên), Thị xã Hoàng Mai (trừ xã Quỳnh Lộc và Quỳnh Trang)"},
            {code: "30", province: "Hà Tĩnh", region: "KV1", details: "Gồm các huyện: Vũ Quang, Hương Sơn, Hương Khê và các xã: Đức Đồng, Đức Lạng, Đức Lập, Tân Hương (thuộc huyện Đức Thọ); Hồng Lộc, Tân Lộc, Thịnh Lộc, Thạch Kim (thuộc huyện Lộc Hà); Gia Hanh, Mỹ Lộc, Sơn Lộc, Thuần Thiện, Thượng Lộc, Phú Lộc (thuộc huyện Can Lộc); Bắc Sơn, Ngọc Sơn, Thạch Điền, Thạch Xuân, Nam Hương, Thạch Lạc, Thạch Bàn, Thạch Hải, Thạch Trị, Thạch Hội, Thạch Đỉnh (thuộc huyện Thạch Hà); Cẩm Mỹ, Cẩm Quan, Cẩm Minh, Cẩm Sơn, Cẩm Thịnh, Cẩm Lĩnh, Cẩm Nhượng, Cẩm Lộc (thuộc huyện Cẩm Xuyên); Kỳ Bắc, Kỳ Đồng, Kỳ Giang, Kỳ Tân, Kỳ Tiến, Kỳ Văn, Kỳ Phong, Kỳ Lạc, Kỳ Lâm, Kỳ Sơn, Kỳ Tây, Kỳ Thượng, Kỳ Trung, Kỳ Hợp, Kỳ Phú, Kỳ Khang (thuộc huyện Kỳ Anh); Các xã, phường: Kỳ Hà, Kỳ Hoa, Kỳ Lợi, Kỳ Nam, Kỳ Thịnh (thuộc Thị xã Kỳ Anh)."},
            {code: "30", province: "Hà Tĩnh", region: "KV2-NT", details: "Gồm các huyện: huyện Đức Thọ, huyện Nghi Xuân, huyện Can Lộc, huyện Thạch Hà, huyện Lộc Hà, huyện Cẩm Xuyên, huyện Kỳ Anh (trừ các xã, thị trấn thuộc KV1) ."},
            {code: "30", province: "Hà Tĩnh", region: "KV2", details: "Gồm các xã, phường của Thành phố Hà Tĩnh; các xã, phường của Thị xã Hồng Lĩnh; các xã, phường của Thị xã Kỳ Anh (trừ các xã, phường thuộc KV1)"},
            {code: "31", province: "Quảng Bình", region: "KV1", details: "Huyện Minh Hóa; Tuyên Hóa; xã Quảng Hợp, Quảng Thạch, Quảng Đông, Quảng Liên, Phù Hóa, Cảnh Hóa, Quảng Châu, Quảng Tiến, Quảng Kim (thuộc huyện Quảng Trạch); xã Quảng Văn, Quảng Sơn, Quảng Minh (thuộc thị xã Ba Đồn); xã Tân Trạch, Thượng Trạch, Xuân Trạch, Lâm Trạch, Liên Trạch, Phúc Trạch, Hưng Trạch, Phú Định, Sơn Trạch, Sơn Lộc, Mỹ Trạch, thị trấn nông trường Việt Trung, Phú Trạch (thuộc huyện Bố Trạch); xã Ngân Thủy, Kim Thủy, Lâm Thủy, Thái Thủy, Văn Thủy, Trường Thủy, thị trấn nông trường Lệ Ninh, Hưng Thủy (thuộc huyện Lệ Thủy); xã Trường Xuân, Trường Sơn, Hải Ninh (thuộc huyện Quảng Ninh)."},
            {code: "31", province: "Quảng Bình", region: "KV2-NT", details: "Huyện Quảng Trạch (trừ các xã thuộc KV1); Huyện Bố Trạch (trừ các xã thuộc KV1); Quảng Ninh (trừ các xã thuộc KV1); Lệ Thủy (trừ các xã thuộc KV1)."},
            {code: "31", province: "Quảng Bình", region: "KV2", details: "Thành phố Đồng Hới; thị xã Ba Đồn (trừ các xã thuộc KV1)."},
            {code: "32", province: "Quảng Trị", region: "KV1", details: "Gồm các huyện: Cồn Cỏ, Hướng Hoá, Đakrông; các xã: Vĩnh Ô, Vĩnh Khê, Vĩnh Hà, thị trấn Bến Quan (thuộc huyện Vĩnh Linh); Vĩnh Trường, Linh Thượng, Hải Thái (thuộc huyện Gio Linh); Cam Tuyền, Cam Thành, Cam Chính, Cam Nghĩa (thuộc huyện Cam Lộ); các xã bãi ngang gồm: Hải An, Hải Khê (thuộc huyện Hải Lăng); Vĩnh Thái, Vĩnh Thạch, Vĩnh Giang (thuộc huyện Vĩnh Linh); Trung Giang, Gio Hải, Gio Việt, Gio Mai (thuộc huyện Gio Linh); Triệu Vân, Triệu An, Triệu Lăng, Triệu Phước, Triệu Độ (thuộc huyện Triệu Phong)."},
            {code: "32", province: "Quảng Trị", region: "KV2-NT", details: "Gồm các huyện: Vĩnh Linh, Gio Linh, Cam Lộ, Triệu Phong, Hải Lăng (trừ các xã thuộc KV1)."},

            {code: "32", province: "Quảng Trị", region: "KV2", details: "Gồm các xã, phường của thành phố Đông Hà và thị xã Quảng Trị."},
            {code: "33", province: "Thừa Thiên Huế", region: "KV1", details: "Các xã thuộc huyện A Lưới, huyện Nam Đông; các xã Phong Sơn, Phong Xuân, Phong Mỹ, Phong Chương, Điền Hương, Phong Bình, Điền Hòa, Điền Môn (thuộc huyện Phong Điền); các xã Quảng Lợi, Quảng An, Quảng Phước, Quảng Thái, Quảng Công, Quảng Ngạn, Quảng Thành (thuộc huyện Quảng Điền); các xã Bình Điền, Bình Thành, Hồng Tiến, Hương Thọ, Hương Bình (thuộc thị xã Hương Trà); các xã Phú An, Vinh An, Vinh Thái, Vinh Phú, Vinh Hà, Phú Xuân, Phú Diên, Vinh Xuân (thuộc huyện Phú Vang); các xã Phú Sơn, Dương Hòa (thuộc thị xã Hương Thủy), các xã Lộc Bình, Lộc Bổn, Lộc Hòa, Lộc Trì, Lộc Vĩnh, Vinh Giang, Vinh Hải, Vinh Mỹ, Vinh Hiền, Xuân Lộc, Thị trấn Lăng Cô (thuộc huyện Phú Lộc)."},
            {code: "33", province: "Thừa Thiên", region: "KV2-NT", details: "Các xã thuộc huyện Phong Điền, Quảng Điền, Phú Vang, Phú Lộc (Trừ các xã thuộc KV1)"},
            {code: "33", province: "Thừa Thiên", region: "KV2", details: "Thành phố Huế; Thị xã Hương Trà; Hương Thủy (Trừ các xã thuộc KV1 của thị xã Hương Trà, thị xã Hương Thủy)"},
            {code: "34", province: "Quảng Nam", region: "KV1", details: "Gồm các huyện: Nam Giang, Đông Giang, Tây Giang, Phước Sơn, Bắc Trà My, Nam Trà My, Hiệp Đức, Tiên Phước, Nông Sơn và các xã: Tam Lãnh (thuộc huyện Phú Ninh); Đại Đồng, Đại Hồng, Đại Lãnh, Đại Quang, Đại Tân, Đại Hưng, Đại Chánh, Đại Sơn, Đại Thạnh (thuộc huyện Đại Lộc); Quế Phong (thuộc huyện Quế Sơn); Tam Mỹ Đông, Tam Mỹ Tây, Tam Sơn, Tam Thạnh, Tam Trà, Tam Tiến, Tam Hải (thuộc huyện Núi Thành); Duy Sơn, Duy Phú, Duy Vinh, Duy Nghĩa, Duy Hải (thuộc huyện Duy Xuyên); Bình Phú, Bình Lãnh, Bình Hải, Bình Nam, Bình Đào (thuộc huyện Thăng Bình)."},
            {code: "34", province: "Quảng Nam", region: "KV2-NT", details: "Gồm các huyện: Duy Xuyên, Thăng Bình, Đại Lộc, Quế Sơn, Núi Thành, Phú Ninh (trừ các xã thuộc KV1)."},

            {code: "34", province: "Quảng Nam", region: "KV2", details: "Gồm: Thị xã Điện Bàn; thành phố: Tam Kỳ, Hội An"},
            {code: "35", province: "Quảng Ngãi", region: "KV1", details: "Gồm các xã, thị trấn thuộc các huyện: Sơn Tây, Sơn Hà, Minh Long, Ba Tơ, Trà Bồng, Tây Trà, Lý Sơn và các xã: Bình An, Bình Khương, Bình Hải, Bình Châu, Bình Thuận, Bình Thạnh, Bình Đông, Bình Chánh (thuộc huyện Bình Sơn); Tịnh Hiệp, Tịnh Đông, Tịnh Giang (thuộc huyện Sơn Tịnh); Nghĩa Lâm, Nghĩa Thọ, Nghĩa Sơn (thuộc huyện Tư Nghĩa); Hành Dũng, Hành Thiện, Hành Tín Tây, Hành Tín Đông, Hành Nhân (thuộc huyện Nghĩa Hành); Đức Phú, Đức Minh, Đức Lợi, Đức Thắng, Đức Chánh, Đức Phong (thuộc huyện Mộ Đức); Phổ Phong, Phổ Nhơn, Phổ An, Phổ Châu, Phổ Quang, Phổ Khánh (thuộc huyện Đức Phổ); Tịnh Kỳ (thuộc thành phố Quảng Ngãi)."},
            {code: "35", province: "Quảng Ngãi", region: "KV2 -NT", details: "Gồm các huyện: Bình Sơn, Sơn Tịnh, Tư Nghĩa, Nghĩa Hành, Mộ Đức, Đức Phổ (trừ các xã thuộc KV1)."},
            {code: "35", province: "Quảng Ngãi", region: "KV2", details: "Gồm các xã, phường của thành phố Quảng Ngãi (trừ các xã thuộc KV1)."},
            {code: "36", province: "Kon Tum", region: "KV1", details: "Toàn tỉnh"},
            {code: "37", province: "Bình Định", region: "KV1", details: "Gồm 03 huyện: An Lão; Vĩnh Thạnh; Vân Canh và các xã: Vĩnh An, Tây Giang, Bình Tân, Tây Phú, Tây Thuận, Tây Xuân, Bình Thuận (thuộc huyện Tây Sơn); Đắc Mang, Ân Sơn, Bok Tới, Ân Nghĩa, Ân Hữu, Ân Tường Đông, Ân Tường Tây, Ân Hảo Đông, Ân Hảo Tây (thuộc huyện Hoài Ân); Hoài Sơn (thuộc huyện Hoài Nhơn); Nhơn Châu, Phước Mỹ, phường Bùi Thị Xuân (thuộc thành phố Quy Nhơn); Cát Sơn, Cát Hải, Cát Tài, Cát Hưng, Cát Thành, Cát Khánh, Cát Minh, Cát Chánh, Cát Lâm, Cát Tiến (thuộc huyện Phù Cát); Mỹ Châu, Mỹ Đức, Mỹ Thọ, Mỹ Thắng, Mỹ An, Mỹ Thành, Mỹ Cát, Mỹ Lợi (thuộc huyện Phù Mỹ); Phước Thành, Phước Thắng (thuộc huyện Tuy Phước)."},
            {code: "37", province: "Bình Định", region: "KV2-NT", details: "Gồm các huyện: Hoài Ân; Hoài Nhơn; Phù Mỹ; Phù Cát; Tây Sơn; Tuy Phước. (Trừ các xã thuộc KV1 đã ghi ở trên)."},
            {code: "37", province: "Bình Định", region: "KV2", details: "Gồm: Thị xã An Nhơn; Thành phố Quy Nhơn. (Trừ 03 xã, phường thuộc KV1 của TP. Quy Nhơn đã ghi ở trên)"},

            {code: "38", province: "Gia Lai", region: "KV1", details: "Toàn tỉnh"},

            {code: "39", province: "Phú Yên", region: "KV1", details: "Gồm các huyện: Sơn Hòa, Sông Hinh, Đồng Xuân và các xã: Hòa Mỹ Tây, Hòa Thịnh, Sơn Thành Đông, Sơn Thành Tây (thuộc huyện Tây Hòa); các xã Xuân Lâm, Xuân Thịnh, Xuân Thọ 2, Xuân Phương, Xuân Bình, Xuân Hòa (thuộc thị xã Sông Cầu); An Hải, An Hòa, An Ninh Đông, An Ninh Tây, An Hiệp, An Lĩnh, An Thọ, An Xuân (thuộc huyện Tuy An); Hòa Tâm (thuộc huyện Đông Hòa); Hòa Hội (thuộc huyện Phú Hòa)."},

            {code: "39", province: "Phú Yên", region: "KV2-NT", details: "Gồm các huyện: Tây Hòa, Tuy An, Phú Hòa, Đông Hòa; trừ các xã Hòa Mỹ Tây, Hòa Thịnh, Sơn Thành Đông, Sơn Thành Tây (thuộc huyện Tây Hòa); An Hải, An Hòa, An Ninh Đông, An Ninh Tây, An Hiệp, An Lĩnh, An Thọ, An Xuân ( thuộc huyện Tuy An); Hòa Tâm (thuộc huyện Đông Hòa); Hòa Hội (thuộc huyện Phú Hòa)."},
            {code: "39", province: "Phú Yên", region: "KV2", details: "Gồm các xã, phường của thành phố Tuy Hòa và thị xã Sông Cầu; trừ các xã Xuân Lâm, Xuân Thịnh, Xuân Thọ 2, Xuân Phương, Xuân Bình, Xuân Hòa (thuộc thị xã Sông Cầu)."},

            {code: "40", province: "Đắk Lắk", region: "KV1", details: "Toàn tỉnh"},

            {code: "41", province: "Khánh Hoà", region: "KV1", details: "Các xã Sinh Tồn, xã Song Tử Tây và thị trấn Trường Sa (thuộc huyện đảo Trường Sa); thị trấn Khánh Vĩnh và các xã: Cầu Bà, Giang Ly, Khánh Bình, Khánh Đông, Khánh Hiệp, Khánh Nam, Khánh Phú, Khánh Thành, Khánh Thượng, Khánh Trung, Liên Sang, Sông Cầu, Sơn Thái (thuộc huyện Khánh Vĩnh); Thị trấn Tô Hạp và các xã: Ba Cụm Bắc, Ba Cụm Nam, Sơn Bình, Sơn Hiệp, Sơn Lâm, Sơn Trung, Thành Sơn (thuộc huyện Khánh Sơn); xã Cam An Bắc, Cam An Nam, Cam Hiệp Bắc, Cam Hòa, Cam Phước Tây, Cam Tân, Sơn Tân, Suối Cát, Suối Tân (thuộc Huyện Cam Lâm); xã Ninh Sơn, Ninh Tân, Ninh Tây, Ninh Thượng, Ninh Vân (thuộc thị xã Ninh Hòa); xã Cam Bình, Cam Phước Đông, Cam Thành Nam, Cam Thịnh Tây (thuộc thành phố Cam Ranh); xã Đại Lãnh, xã Vạn Bình, Vạn Khánh, Vạn Long, Vạn Lương, Vạn Phú, Vạn Phước, Vạn Thạnh, Vạn Thọ, Xuân Sơn (thuộc huyện Vạn Ninh); xã Diên Tân, Suối Tiên (thuộc huyện Diên Khánh); Phường Vĩnh Nguyên (thuộc Thành phố Nha Trang)"},
            {code: "41", province: "Khánh Hoà", region: "KV2-NT", details: "Các huyện: Cam Lâm, Diên Khánh, Vạn Ninh (trừ các xã thuộc KV1)."},
            {code: "41", province: "Khánh Hoà", region: "KV2", details: "Gồm các xã, phường của thành phố Nha Trang, thành phố Cam Ranh và thị xã Ninh Hòa (trừ các xã thuộc KV1)."},

            {code: "42", province: "Lâm Đồng", region: "KV1", details: "Toàn tỉnh"},

            {code: "43", province: "Bình Phước", region: "KV1", details: "Gồm các huyện: TP. Đồng Xoài, TX. Phước Long, TX. Bình Long, Đồng Phú, Bù Đăng, Phú Riềng, Bù Gia Mập, Bù Đốp, Lộc Ninh, Hớn Quản, Chơn Thành (trừ các xã Minh Hưng, Minh Long, Thành Tâm, TT. Chơn Thành)."},
            {code: "43", province: "Bình Phước", region: "KV2-NT", details: "Gồm các xã: Minh Hưng, Minh Long, Thành Tâm, TT. Chơn Thành của huyện Chơn Thành"},

            {code: "44", province: "Bình Dương", region: "KV2-NT", details: "Gồm tất cả các huyện: Bàu Bàng, Phú Giáo, Dầu Tiếng và Bắc Tân Uyên"},
            {code: "44", province: "Bình Dương", region: "KV2", details: "Gồm Thành phố Thủ Dầu Một và các thị xã: Thuận An, Dĩ An, Bến Cát, Tân Uyên"},

            {code: "45", province: "Ninh Thuận", region: "KV1", details: "Gồm các xã Thành Hải (TP. Phan Rang-Tháp Chàm), Phước Minh, Nhị Hà, Phước Hà, Phước Dinh; Phước Nam, Phước Ninh (thuộc huyện Thuận Nam), Thị trấn Phước Dân, An Hải, Phước Hậu, Phước Hữu, Phước Sơn, Phước Thuận, Phước Vinh, Phước Thái, Phước Hải (thuộc huyện Ninh Phước), Xuân Hải, Vĩnh Hải (thuộc huyện Ninh Hải), Phước Bình, Phước Chính, Phước Đại, Phước Hoà, Phước Tân, Phước Thắng, Phước Thành, Phước Tiến, Phước Trung (thuộc huyện Bác Ái), Nhơn Sơn, Lâm Sơn, Lương Sơn, Mỹ Sơn, Quảng Sơn, Hoà Sơn, Ma Nới (thuộc huyện Ninh Sơn); Công Hải, Lợi Hải, Bắc Sơn, Phước Chiến, Phước Kháng (thuộc huyện Thuận Bắc)."},
            {code: "45", province: "Ninh Thuận", region: "KV2-NT", details: "Gồm các huyện Ninh Hải (trừ các xã thuộc KV1 ghi ở trên), Ninh Phước (trừ các xã thuộc KV1 ghi ở trên), Thuận Nam (trừ các xã thuộc KV1 ghi ở trên), Thuận Bắc (trừ các xã thuộc KV1 ghi ở trên), Ninh Sơn (trừ các xã thuộc KV1 ghi ở trên)."},
            {code: "45", province: "Ninh Thuận", region: "KV2", details: "Gồm các phường của thành phố Phan Rang-Tháp Chàm."},
            {code: "46", province: "Tây Ninh", region: "KV1", details: "Gồm các xã : Suối Ngô, Tân Hà, Suối Dây, Tân Đông, Tân Hòa, Tân Hội, Tân Thành, Tân Hưng, Tân Phú (huyện Tân Châu); Tân Bình, Hòa Hiệp (huyện Tân Biên); Phước Vinh, Biên Giới, Hòa Hội, Hòa Thạnh, Ninh Điền, Thành Long (huyện Châu Thành); Tiên Thuận, Lợi Thuận, Long Phước (huyện Bến Cầu); Suối Đá (huyện Dương Minh Châu); Phường 1, Ninh Thạnh, Tân Bình, Thạnh Tân (Tp.Tây Ninh); Trường Tây (huyện Hòa Thành); Phước Chỉ, Bình Thạnh (huyện Trảng Bàng)."},
            {code: "46", province: "Tây Ninh", region: "KV2-NT", details: "Huyện Bến Cầu, Huyện Hòa Thành, Huyện Châu Thành, Huyện Dương Minh Châu, Huyện Gò Dầu, Huyện Trảng Bàng, Huyện Tân Châu, Huyện Tân Biên (Trừ các xã thuộc khu vực 1 thuộc 07 huyện Hòa Thành, Châu Thành, Dương Minh Châu, Trảng Bàng, Tân Châu, Tân Biên, Bến Cầu)"},

            {code: "46", province: "Tây Ninh", region: "KV2", details: "Thành phố Tây Ninh (Trừ các phường thuộc KV1 của Thành phố Tây Ninh)"},

            {code: "47", province: "Bình Thuận", region: "KV1", details: "Gồm các xã, thị trấn: Bình Thạnh, Phan Dũng, Phong Phú, Phú Lạc, Vĩnh Hảo, Vĩnh Tân, Phước Thể (huyện Tuy Phong); Bình An, Bình Tân, Chợ Lầu, Hải Ninh, Hòa Thắng, Hồng Phong, Hồng Thái, Lương Sơn, Phan Điền, Phan Hiệp, Phan Hòa, Phan Lâm, Phan Rí Thành, Phan Sơn, Phan Thanh, Phan Tiến, Sông Bình, Sông Luỹ (huyện Bắc Bình); Đa Mi, Đông Giang, Đông Tiến, Hàm Chính, Hàm Liêm, Hàm Phú, Hàm Trí, Hồng Liêm, Hồng Sơn, La Dạ, Thuận Hòa, Thuận Minh (huyện Hàm Thuận Bắc); Hàm Cần, Hàm Minh, Hàm Thạnh, Mương Mán, Mỹ Thạnh, Tân Lập, Tân Thuận, Thuận Nam, Thuận Quý (huyện Hàm Thuận Nam); Sơn Mỹ, Sông Phan, Tân Đức, Tân Hà, Tân Minh, Tân Nghĩa, Tân Phúc, Tân Thắng, Tân Xuân, Thắng Hải (huyện Hàm Tân); Bắc Ruộng, Đồng Kho, Đức Bình, Đức Phú, Đức Tân, Đức Thuận, Gia An, Gia Huynh, Huy Khiêm, La Ngâu, Lạc Tánh, Măng Tố, Nghị Đức, Suối Kiết (huyện Tánh Linh); Đa Kai, Đông Hà, Đức Chính, Đức Hạnh, Đức Tài, Đức Tín, Mê Pu, Nam Chính, Sùng Nhơn, Tân Hà, Trà Tân, Võ Xu, Vũ Hòa (huyện Đức Linh), Long Hải, Ngũ Phụng, Tam Thanh (huyện Phú Quý)."},
            {code: "47", province: "Bình Thuận", region: "KV2-NT", details: "Gồm 14 xã, thị trấn: Chí Công, Hòa Minh, Hòa Phú, Liên Hương, Phan Rí Cửa, (huyện Tuy Phong); Hàm Đức, Hàm Hiệp, Hàm Thắng, Ma Lâm, Phú Long (huyện Hàm Thuận Bắc); Hàm Cường, Hàm Kiệm, Hàm Mỹ, Tân Thành (huyện Hàm Thuận Nam)"},
            {code: "47", province: "Bình Thuận", region: "KV2", details: "Gồm 27 phường, xã: Bình Hưng, Đức Long, Đức Nghĩa, Đức Thắng, Hàm Tiến, Hưng Long, Lạc Đạo, Mũi Né, Phong Nẵm, Phú Hài, Phú Tài, Phú Thuỷ, Phú Trinh, Thanh Hải, Thiện Nghiệp, Tiến Lợi, Tiến Thành, Xuân An (TP. Phan Thiết); Bình Tân, Phước Hội, Phước Lộc, Tân An, Tân Bình, Tân Hải, Tân Phước, Tân Thiện, Tân Tiến (thị xã La Gi)"},

            {code: "48", province: "Đồng Nai", region: "KV1", details: "Gồm các xã: Thị trấn Tân Phú, Đắc Lua, Nam Cát Tiên, Núi Tượng, Phú An, Phú Bình, Phú Điền, Phú Lập, Phú Lộc, Phú Sơn, Phú Thịnh, Phú Trung, Tà Lài, Thanh Sơn, Trà Cổ (thuộc huyện Tân Phú), Thị trấn Định Quán, Gia Canh, La Ngà, Ngọc Định, Phú Cường, Phú Hòa, Phú Lợi, Phú Ngọc, Phú Tân, Phú Túc, Phú Vinh, Suối Nho, Túc Trưng, Thanh Sơn (thuộc huyện Định Quán), Thị trấn Gia Ray, Bảo Hòa, Lang Minh, Suối Cao, Suối Cát, Xuân Bắc, Xuân Định, Xuân Hiệp, Xuân Hòa, Xuân Hưng, Xuân Phú, Xuân Tâm, Xuân Thành, Xuân Thọ, Xuân Trường (thuộc huyện Xuân Lộc), Bảo Bình, Lâm San, Long Giao, Nhân Nghĩa, Sông Nhạn, Sông Ray, Thừa Đức, Xuân Bảo, Xuân Đông, Xuân Đường, Xuân Mỹ, Xuân Quế, Xuân Tây (thuộc huyện Cẩm Mỹ), Bảo Quang, Bàu Sen, Bàu Trâm, Xuân Lập (thuộc Thị xã Long Khánh), An Viễn, Bàu Hàm, Cây Gáo, Đồi 61, Đông Hòa, Hố Nai 3, Hưng Thịnh, Sông Thao, Sông Trầu, Tây Hòa, Thanh Bình, Trung Hòa (thuộc huyện Trảng Bom), Bàu Hàm 2, Hưng Lộc, Lộ 25, Xuân Thạnh, Xuân Thiện (thuộc huyện Thống Nhất), Trị An, Vĩnh Tân, Thị trấn Vĩnh An, Hiếu Liêm, Phú Lý, Mã Đà (thuộc huyện Vĩnh Cửu), Bình Sơn, Phước Bình, Tân Hiệp (thuộc huyện Long Thành)."},
            {code: "48", province: "Đồng Nai", region: "KV2-NT", details: "Gồm các huyện: Tân Phú, Định Quán, Xuân Lộc, Cẩm Mỹ, Trảng Bom, Thống Nhất, Vĩnh Cửu, Long Thành, Nhơn Trạch (trừ các xã, thị trấn thuộc KV1 của các huyện đã ghi ở trên)."},
            {code: "48", province: "Đồng Nai", region: "KV2", details: "Gồm các xã, phường của thành phố Biên Hòa và thị xã Long Khánh (trừ các xã thuộc KV1 của thị xã Long Khánh đã ghi ở trên)."},
            {code: "49", province: "Long An", region: "KV1", details: "Gồm các xã: Hưng Điền A, Thái Bình Trung, Thái Trị, Tuyên Bình (thuộc huyện Vĩnh Hưng); Bình Hòa Tây, Bình Thạnh (thuộc huyện Mộc Hóa); Tân Hiệp, Thuận Bình (thuộc huyện Thạnh Hóa); Bình Hòa Hưng, Mỹ Bình, Mỹ Quý Đông, Mỹ Quý Tây, Mỹ Thạnh Tây (thuộc huyện Đức Huệ); Phước Vĩnh Đông (thuộc huyện Cần Giuộc); Hưng Điền, Hưng Điền B, Hưng Hà (thuộc huyện Tân Hưng); Bình Tân (thuộc thị xã Kiến Tường)."},
            {code: "49", province: "Long An", region: "KV2-NT", details: "Gồm các huyện: Vĩnh Hưng (trừ các xã thuộc KV1); Mộc Hóa (trừ các xã thuộc KV1); Tân Thạnh; Thạnh Hóa (trừ các xã thuộc KV1); Đức Huệ (trừ các xã thuộc KV1); Đức Hòa; Bến Lức; Thủ Thừa; Châu Thành; Tân Trụ; Cần Đước; Cần Giuộc (trừ các xã thuộc KV1); Tân Hưng (trừ các xã thuộc KV1)."},
            {code: "49", province: "Long An", region: "KV2", details: "Gồm: Thành phố Tân An; Thị xã Kiến Tường (trừ các xã thuộc KV1)"},

            {code: "50", province: "Đồng Tháp", region: "KV1", details: "Gồm các xã Thường Phước 1, Thường Thới Hậu A, Thường Thới Hậu B (thuộc huyện Hồng Ngự); Tân Hội, Bình Thạnh (thuộc thị xã Hồng Ngự); Tân Hộ Cơ, Thông Bình, Bình Phú (thuộc huyện Tân Hồng)"},
            {code: "50", province: "Đồng Tháp", region: "KV2-NT", details: "Gồm tất cả các huyện: Châu Thành; Lai Vung; Lấp Vò; huyện Cao Lãnh; Tháp Mười; Tam Nông; Thanh Bình; huyện Hồng Ngự; Tân Hồng (trừ một số xã thuộc KV1 huyện Hồng Ngự; Tân Hồng)"},
            {code: "50", province: "Đồng Tháp", region: "KV2", details: "Gồm: thành phố Cao Lãnh; thành phố Sa Đéc; thị xã Hồng Ngự (trừ một số xã thuộc KV1 của thị xã Hồng Ngự)."},

            {code: "51", province: "An giang", region: "KV1", details: "Huyện An Phú (09 xã): Đa Phước, Vĩnh Trường, Khánh An, Khánh Bình, Nhơn Hội, Phú Hội, Phú Hữu, Quốc Thái, Vĩnh Hội Đông Thị xã Tân Châu (03 xã): Châu Phong, Phú Lộc, Vĩnh Xương Huyện Tịnh Biên (13 xã, thị trấn): thị trấn Chi Lăng, thị trấn Nhà Bàng, thị trấn Tịnh Biên, An Cư, An Hảo,Núi Voi, Tân Lợi, Thới Sơn, Vĩnh Trung, An Nông, An Phú, Nhơn Hưng, Văn Giáo Huyện Tri Tôn (12 xã, thị trấn): thị trấn Ba Chúc, thị trấn Tri Tôn, An Tức, Châu Lăng, Cô Tô, Lê Trì, Lương An Trà, Lương Phi, Ô Lâm, Lạc Quới, Núi Tô, Vĩnh Gia. Huyện Châu Phú (02 xã): Bình Mỹ, Khánh Hòa Huyện Châu Thành (04 xã): Cần Đăng, Hòa Bình Thạnh, Vĩnh Hanh, Vĩnh Thành Huyện Thoại Sơn (01 thị trấn): Óc Eo"},
            {code: "51", province: "An giang", region: "KV2NT", details: "Gồm tất cả các huyện: Chợ Mới, Phú Tân, An Phú, Châu Phú, Châu Thành, Thoại Sơn, Tri Tôn, Tịnh Biên (trừ các xã, thị trấn thuộc KV1)"},
            {code: "51", province: "An giang", region: "KV2", details: "Gồm: Thành phố Long Xuyên, Thành phố Châu Đốc và thị xã Tân Châu (trừ các xã, thuộc KV1)."},
            {code: "52", province: "Bà Rịa - Vũng Tàu", region: "KV1", details: "Gồm các xã: Bông Trang, Bưng Riềng, Hòa Bình, Hòa Hội, Xuyên Mộc, Bàu Lâm, Bình Châu, Phước Tân, Tân Lâm, Hòa Hiệp (thuộc huyện Xuyên Mộc); TT Ngãi Giao, Bàu Chinh, Bình Ba, Bình Giã, Cù Bị, Kim Long, Láng Lớn, Nghĩa Thành, Quảng Thành, Sơn Bình, Suối Nghệ, Xà Bang, Xuân Sơn, Bình Trung, Đá Bạc, Suối Rao (thuộc Huyện Châu Đức); Châu Pha, Hắc Dịch, Sông Xoài, Tóc Tiên (thuộc Thị xã Phú Mỹ)."},
            {code: "52", province: "Bà Rịa - Vũng Tàu", region: "KV2-NT", details: "Gồm tất cả các huyện: Châu Đức, Long Điền, Đất Đỏ, Xuyên Mộc, Côn Đảo (trừ một số xã thuộc KV1 của 2 huyện Xuyên Mộc, Châu Đức và Thị xã Phú Mỹ đã ghi ở trên)."},
            {code: "52", province: "Bà Rịa - Vũng", region: "KV2", details: "Gồm: Thị xã Phú Mỹ, Thành phố Bà Rịa, Thành phố Vũng Tàu."},

            {code: "53", province: "Tiền Giang", region: "KV1", details: "Toàn huyện Tân Phú Đông và các xã Bình Xuân, Bình Đông (thuộc thị xã Gò Công), Gia Thuận, Kiểng Phước, Phước Trung (thuộc huyện Gò Công Đông)."},
            {code: "53", province: "Tiền Giang", region: "KV2-NT", details: "Các tất cả các huyện: Cái Bè; Cai Lậy; Châu Thành; Tân Phước; Chợ Gạo; Gò Công Tây; Gò Công Đông (trừ các xã Gia Thuận, Kiểng Phước, Phước Trung thuộc KV1)."},
            {code: "53", province: "Tiền Giang", region: "KV2", details: "Thành phố Mỹ Tho, Thị xã Cai Lậy; Thị xã Gò Công (trừ các xã Bình Đông, Bình Xuân thuộc KV1)."},

            {code: "54", province: "Kiên Giang", region: "KV1", details: "Gồm các huyện, xã, thị trấn: xã Phi Thông (thuộc TP Rạch Giá); xã Mỹ Đức, xã Tiên Hải (thuộc Thị xã Hà Tiên); Thị trấn Kiên Lương, xã Bình An, xã Dương Hòa, xã Hòa Điền, xã Sơn Hải, xã Hòn Nghệ (thuộc Huyện Kiên Lương); Thị trấn Sóc Sơn, xã Bình Giang, xã Lình Huỳnh, xã Sơn Kiên, xã Thổ Sơn (thuộc Huyện Hòn Đất); xã Thạnh Trị (thuộc Huyện Tân Hiệp); Thị trấn Minh Lương, xã Bình An, xã Mong Thọ B, xã Vĩnh Hoà Hiệp, xã Vĩnh Hoà Phú (thuộc Huyện Châu Thành); Huyện Giồng Riềng; Huyện Gò Quao; Thị trấn Thứ Ba, xã Đông Thái, xã Đông Yên, xã Nam Thái, xã Nam Thái A, xã Nam Yên, xã Tây Yên (thuộc Huyện An Biên); Xã Đông Hưng A, xã Thuận Hòa, xã Vân Khánh, xã Vân Khánh Đông, xã Vân Khánh Tây, xã Tân Thạnh (thuộc Huyện An Minh); Huyện Vĩnh Thuận, Huyện Phú Quốc; Huyện Kiên Hải; xã Hòa Chánh, xã Minh Thuận, xã Thạnh Yên, xã Thạnh Yên A, xã Vĩnh Hòa (thuộc Huyện U Minh"},
            {code: "54", province: "Kiên Giang", region: "KV2-NT", details: "Gồm tất cả các huyện: Kiên Lương; Hòn Đất; Tân Hiệp; Châu Thành; An Biên; An Minh; U Minh Thượng (trừ các xã thuộc KV1)."},
            {code: "54", province: "Kiên Giang", region: "KV2", details: "Gồm: Thành phố Rạch Giá; Thành phố Hà Tiên (trừ các xã thuộc KV1"},


            {code: "55", province: "Cần Thơ", region: "KV1", details: "Gồm xã: Thới Xuân (thuộc huyện Cờ Đỏ)"},
            {code: "55", province: "Cần Thơ", region: "KV2", details: "Gồm các xã, phường, thị trấn: Thị trấn Thạnh An, Vĩnh Bình, Thạnh Quới, Thị trấn Vĩnh Thạnh, Thạnh An, Thạnh Tiến, Thạnh Mỹ, Vĩnh Trinh, Thạnh Lộc, Thạnh Thắng, Thạnh Lợi (thuộc huyện Vĩnh Thạnh); Thị trấn Cờ Đỏ, Thới Hưng, Trung An, Trung Thạnh,Thới Đông, Đông Hiệp, Đông Thắng, Thạnh Phú, Trung Hưng (thuộc huyện Cờ Đỏ); Thị trấn Thới Lai, Thới Thạnh, Tân Thạnh, Định Môn, Xuân Thắng, Thới Tân, Trường Thành, Trường Xuân, Trường Xuân A, Trường Xuân B, Trường Thắng, Đông Thuận, Đông Bình (thuộc huyện Thới Lai); Tân Thới, Nhơn Nghĩa, Nhơn Ái, Thị trấn Phong Điền, Giai Xuân, Mỹ Khánh, Trường Long (thuộc huyện Phong Điền)."},
            {code: "55", province: "Cần Thơ", region: "KV3", details: "Gồm các phường: Cái Khế, An Hòa, Thới Bình, An Nghiệp, An Cư, An Hội, Tân An, An Lạc, An Phú, Xuân Khánh, Hưng Lợi, An Bình, An Khánh (thuộc quận Ninh Kiều); Phường Thới An Đông, Long Tuyền, Long Hòa, Bình Thủy, An Thới, Bùi Hữu Nghĩa, Trà Nóc, Trà An (thuộc quận Bình Thủy); Phường Ba Láng, Lê Bình, Thường Thạnh, Phú Thứ, Tân Phú, Hưng Phú, Hưng Thạnh (thuộc quận Cái Răng); Trường Lạc, Thới Long, Long Hưng, Thới An, Phước Thới, Châu Văn Liêm, Thới Hòa (thuộc quận Ô Môn);Phường Thốt Nốt, Thới Thuận, Thuận An, Trung Kiên, Tân Lộc, Trung Nhứt, Thạnh Hòa, Thuận Hưng, Tân Hưng (thuộc quận Thốt Nốt)."},
            {code: "56", province: "Bến Tre", region: "KV1", details: "Gồm các xã Thừa Đức, Phú Vang, Vang Quới Đông, Đại Hòa Lộc, Thạnh Trị, Phú Long (06 xã thuộc huyện Bình Đại); Tân Thủy, Bảo Thuận, An Thủy, Bảo Thạnh, An Hòa Tây, An Ngãi Tây, Tân Hưng, An hiệp, Tân Xuân, An Đức (10 xã thuộc huyện Ba Tri); Thạnh Phong, Thạnh Hải, An Điền, Giao Thạnh, Mỹ An, Bình Thạnh, An Nhơn, An Qui, An Thuận (09 xã thuộc huyện Thạnh Phú); Thành Thới A, Thành Thới B, Bình Khánh Đông (03 xã thuộc huyện Mỏ Cày Nam); Thạnh Phú Đông, Hưng Phong (02 xã thuộc huyện Giồng Trôm), Tiên Long (01 xã thuộc huyện Châu Thành)"},
            {code: "56", province: "Bến Tre", region: "KV2-NT", details: "Gồm tất cả các huyện: Bình Đại, Châu Thành, Chợ Lách, Mỏ Cày Bắc, Mỏ Cày Nam, Thạnh Phú, Giồng Trôm, Ba Tri (trừ một số xã thuộc KV1 của huyện Bình Đại, Ba Tri, Thạnh Phú, Mỏ Cày Nam, Giồng Trôm, Châu Thành đã ghi ở trên)."},
            {code: "56", province: "Bến Tre", region: "KV2", details: "TP. Bến Tre"},

            {code: "57", province: "Vĩnh Long", region: "KV1", details: "Gồm các xã, phường: Đông Thuận, Thuận An, Đông Bình, Đông Thành, Cái Vồn (thị xã Bình Minh); Loan Mỹ (huyện Tam Bình); Hựu Thành, Trà Côn, Tân Mỹ (huyện Trà Ôn); Trung Thành (huyện Vũng Liêm)."},
            {code: "57", province: "Vĩnh Long", region: "KV2-NT", details: "Gồm các xã của huyện Long Hồ, huyện Mang Thít, huyện Vũng Liêm (trừ xã Trung Thành), huyện Tam Bình (trừ xã Loan Mỹ), huyện Trà Ôn (trừ xã Hựu Thành, Tân Mỹ, Trà Côn), huyện Bình Tân."},
            {code: "57", province: "Vĩnh Long", region: "KV2", details: "Gồm các phường 1, 2, 3, 4, 5, 8, 9; xã Tân Hòa, xã Tân Ngãi, xã Trường An, xã Tân Hội (thành phố Vĩnh Long), Thị xã Bình Minh (trừ xã, phường Đông Thuận, Thuận An, Đông Bình, Đông Thành, Cái Vồn)."},

            {code: "58", province: "Trà Vinh", region: "KV1", details: "Gồm: xã Huyền Hội, xã Bình Phú, xã Phương Thạnh (thuộc huyện Càng Long); xã Đại An, xã Hàm Giang, xã Long Hiệp, xã An Quảng Hữu, xã Ngọc Biên, xã Phước Hưng, xã Tân Hiệp, xã Thanh Sơn, xã Kim Sơn, xã Lưu Nghiệp Anh, xã Hàm Tân, thị trấn Trà Cú, thị trấn Định An, xã Tân Sơn, xã Ngãi Xuyên, xã Tập Sơn, (thuộc huyện Trà Cú); xã Hòa Lợi, xã Đa Lộc, xã Lương Hòa, xã Mỹ Chánh, xã Song Lộc, xã Hòa Minh, xã Long Hòa, xã Lương Hòa A, thị trấn Châu Thành, xã Nguyệt Hóa, xã phước Hảo, xã Thanh Mỹ, (thuộc huyện Châu Thành); xã Phong Phú, xã Hòa Tân, thị trấn Cầu Kè, xã Tam Ngãi, xã Thông Hòa, xã Châu Điền, xã Hòa Ân, xã Phong Thạnh, (thuộc huyện Cầu Kè); xã Nhị Trường, xã Thuận Hòa, xã Kim Hòa, xã Long Sơn, xã Thạnh Hòa Sơn, xã Trường Thọ, thị trấn Cầu Ngang, xã Hiệp Hòa, xã Mỹ Hòa (thuộc huyện Cầu Ngang); xã Hùng Hòa, xã Long Thới, Ngãi Hùng, xã Tân Hòa, xã Tân Hùng, xã Hiếu Tử, thị trấn Tiểu Cần, xã Hiếu Trung, xã Phú Cần, xã Tập Ngãi (thuộc huyện Tiểu Cần); xã Ngũ Lạc, xã Long Vĩnh, xã Long Khánh, thị trấn Long Thành, Xã Đông Hải, xã Đôn Xuân, xã Đôn Châu (thuộc huyện Duyên Hải); Phường 1, 3, 5, 6, 7, 8, 9 và xã Long Đức (thuộc thành phố Trà Vinh)."},
            {code: "58", province: "Trà Vinh", region: "KV2-NT", details: "Gồm: xã Mỹ Cẩm, xã An Trường A, xã An Trường, xã Tân An, xã Tân Bình, xã Đại Phúc, xã Nhị Long Phú, xã Nhị Long, xã Đức Mỹ, xã Đại Phước, thị trấn Càng Long; xã Hưng Mỹ; xã An Phú Tân, xã Thạnh Phú; xã Hiệp Mỹ Tây, xã Hiệp Mỹ Đông, xã Mỹ Long Bắc, xã Mỹ Long Nam, xã Vinh Kim, thị trấn Mỹ Long; thị trấn Cầu Quan, xã Định An, xã Hòa Thuận, xã Ninh Thới. (trừ một số xã thuộc KV1 của huyện Càng Long, Châu Thành, Cầu Kè, Cầu Ngang, Tiểu Cần)."},
            {code: "58", province: "Trà Vinh", region: "KV2", details: "Gồm: Phường 2, Phường 4 (thuộc thành phố Trà Vinh); xã Long Hữu, Phường 1, Phường 2, xã Long Toàn, xã Dân Thành, xã Trường Long Hòa, xã Hiệp Thạnh (thuộc thị xã Duyên Hải)."},
            {code: "59", province: "Sóc Trăng", region: "KV1", details: "Toàn tỉnh (trừ thị trấn An Lạc Thôn thuộc huyện Kế Sách)"},
            {code: "59", province: "Sóc Trăng", region: "KV2-NT", details: "Thị trấn An Lạc Thôn thuộc huyện Kế Sách"},

            {code: "60", province: "Bạc Liêu", region: "KV1", details: "Gồm các xã, thị trấn: xã Châu Hưng A, xã Vĩnh Hưng, xã Vĩnh Hưng A, xã Hưng Hội, xã Long Thạnh (thuộc huyện Vĩnh Lợi); xã Vĩnh Hậu, xã Minh Diệu, xã Vĩnh Thịnh, thị trấn Hòa Bình, xã Vĩnh Mỹ A (thuộc huyện Hòa Bình); xã Ninh Quới, xã Ninh Thạnh Lợi, xã Vĩnh Lộc, xã Vĩnh Lộc A, xã Ninh Hòa, xã Lộc Ninh (thuộc huyện Hồng Dân); xã Long Điền, Long Điền Đông, xã Long Điền Đông A, xã Long Điền Tây, xã Điền Hải, xã An Trạch A, xã An Trạch, xã An Phúc (thuộc huyện Đông Hải); xã Phong Thạnh Đông, Phường Hộ Phòng, xã Tân Thạnh, xã Phong Thạnh A (thuộc thị xã Giá Rai); xã Vĩnh Phú Đông, xã Vĩnh Phú Tây (thuộc huyện Phước Long)."},
            {code: "60", province: "Bạc Liêu", region: "KV2-NT", details: "Gồm có các xã, thị trấn: xã Ninh Quới A, xã Ninh Thạnh Lợi A, thị trấn Ngan Dừa (thuộc huyện Hồng Dân); thị trấn Châu Hưng, xã Châu Thới, xã Hưng Thành (thuộc huyện Vĩnh Lợi); xã Vĩnh Bình, xã Vĩnh Mỹ B, xã Vĩnh Hậu A (thuộc huyện Hòa Bình); xã Định Thành, xã Định Thành A và thị trấn Gành Hào (thuộc huyện Đông Hải); xã Vĩnh Thanh, xã Hưng Phú, xã Phước Long, xã Phong Thạnh Tây A, xã Phong Thạnh Tây B, thị trấn Phước Long (thuộc huyện Phước Long)"},
            {code: "60", province: "Bạc Liêu", region: "KV2", details: "Có 7 phường, 03 xã của thành phố Bạc Liêu: xã Vĩnh Trạch Đông, xã Vĩnh Trạch và xã Hiệp Thành, phường 1, phường 2, phường 3, phường 5, phường 7, phường 8, phường Nhà Mát. Các phường, xã thuộc thị xã Giá Rai (Trừ các phường, xã thuộc KV1)."},

            {code: "61", province: "Cà mau", region: "KV1", details: "Gồm: Huyện U Minh; các xã/phường/thị trấn: An Xuyên, Định Bình, Hoà Tân, Hoà Thành, Lý Văn Lâm, Tắc Vân, xã Tân Thành, Phường 2, Phường 4, Phường 5, Phường 6, Phường 7, Phường 8, Phường 9, Phường Tân Thành (thuộc thành phố Cà Mau), thị trấn Thới Bình, Biển Bạch, Biển Bạch Đông, Hồ Thị Kỷ, Tân Bằng, Tân Lộc, Tân Lộc Bắc, Tân Phú, Thới Bình (thuộc huyện Thới Bình), thị trấn Sông Đốc, thị trấn Trần Văn Thời, Khánh Bình Đông, Khánh Bình Tây, Khánh Bình Tây Bắc, Khánh Hải, Khánh Hưng, Lợi An, Phong Lạc, Trần Hợi (thuộc huyện Trần Văn Thời), Đông Thới, Hưng Mỹ, Tân Hưng, Tân Hưng Đông (thuộc huyện Cái Nước), thị trấn Đầm Dơi, Ngọc Chánh, Nguyễn Huân, Quách Phẩm, Quách Phẩm Bắc, Tạ An Khương, Tạ An Khương Đông, Tân Duyệt, Tân Thuận, Tân Tiến, Thanh Tùng, Trần Phán (thuộc huyện Đầm Dơi), Đất Mũi, Tam Giang Tây, Tân Ân, Tân Ân Tây, Viên An, Viên An Đông (thuộc huyện Ngọc Hiển), Lâm Hải, Tam Giang Đông (thuộc huyện Năm Căn), Nguyễn Việt Khái, Tân Hải (thuộc huyện Phú Tân)."},

            {code: "61", province: "Cà mau", region: "KV2-NT", details: "Gồm các xã/thị trấn: Tân Lộc Đông, Trí Lực, Trí Phải (thuộc huyện Thới Bình), Khánh Bình, Khánh Lộc, Phong Điền (thuộc huyện Trần Văn Thời), thị trấn Cái Nước, Đông Hưng, Hoà Mỹ, Lương Thế Trân, Phú Hưng, Thạnh Phú, Trần Thới (thuộc huyện Cái Nước), Tạ An Khương Nam, Tân Dân, Tân Đức, Tân Trung (thuộc huyện Đầm Dơi), thị trấn Rạch Gốc (thuộc huyện Ngọc Hiển), thị trấn Năm Căn, Đất Mới, Hàm Rồng, Hàng Vịnh, Hiệp Tùng, Tam Giang (thuộc huyện Năm Căn), thị trấn Cái Đôi Vàm, Phú Mỹ, Phú Tân, Phú Thuận, Rạch Chèo, Tân Hưng Tây, Việt Thắng (thuộc huyện Phú Tân)."},
            {code: "61", province: "Cà mau", region: "KV2", details: "Gồm các phường: Phường 1, Tân Thành, Tân Xuyên (thuộc thành phố Cà Mau)."},

            {code: "62", province: "Điện Biên", region: "KV1", details: "Toàn tỉnh"},

            {code: "63", province: "Đăk Nông", region: "KV1", details: "Toàn tỉnh"},

            {code: "64", province: "Hậu Giang", region: "KV1", details: "Gồm phường I, phường III, phường IV, phường VII, xã Vị Tân, xã Hỏa Lựu, xã Hỏa Tiến (thuộc thành phố Vị Thanh), xã Vị Thủy, xã Vị Trung, xã Vĩnh Trung, xã Vị Bình, (thuộc huyện Vị Thủy), xã Vĩnh Viễn, Xã Vĩnh Viễn A, xã Xà Phiên, xã Lương Nghĩa, xã Lương Tâm, xã Vĩnh Thuận Đông (thuộc huyện Long Mỹ), Thị trấn Cái Tắc, xã Tân Phú Thạnh, Thị trấn Bảy Ngàn, Xã Trường Long A (thuộc huyện Châu Thành A), xã Hiệp Hưng, thị trấn Búng Tàu, xã Tân Phước Hưng, xã Thạnh Hòa, xã Phụng Hiệp, xã Long Thạnh, xã Tân Bình, xã Hòa An, xã Hòa Mỹ (thuộc huyện Phụng Hiệp), phường Ngã Bảy, phường Lái Hiếu (thuộc thị xã Ngã bảy)."},
            {code: "64", province: "Hậu Giang", region: "KV2-NT", details: "Gồm thị trấn Nàng Mau, xã Vị Thắng, xã Vĩnh Thuận Tây, xã Vĩnh Tường, xã Vị Thanh, xã Vị Đông (thuộc huyện Vị Thủy), thị trấn Cây Dương, xã Phương Bình, xã Tân Long, xã Bình Thành, thị trấn Kinh Cùng, xã Phương Phú (thuộc huyện Phụng Hiệp), thị trấn Một Ngàn, xã Nhơn Nghĩa A, thị trấn Rạch Gòi, xã Thạnh Xuân, xã Tân Hòa, xã Trường Long Tây (thuộc huyện Châu Thành A), huyện Châu Thành, xã Thuận Hưng, xã Thuận Hòa (thuộc huyện Long Mỹ)."},
            {code: "64", province: "Hậu Giang", region: "KV2", details: "Gồm phường V, xã Tân Tiến (thuộc thành phố Vị Thanh); thị xã Long Mỹ; Xã Hiệp Lợi, phường Hiệp Thành, xã Đại Thành, xã Tân Thành (thuộc thị xã Ngã Bảy)."},



        ];

        // Hàm load dữ liệu vào bảng
        function loadRegionData() {
            const tableBody = document.getElementById('regionTableBody');
            tableBody.innerHTML = '';

            regionData.forEach(item => {
                const row = document.createElement('tr');
                let regionClass = item.region.toLowerCase();
                // Xử lý đặc biệt cho KV2-NT
                if (regionClass === 'kv2-nt') {
                    regionClass = 'kv2nt';
                } else {
                    regionClass = regionClass.replace('-', '');
                }

                row.innerHTML = `
                    <td>${item.code}</td>
                    <td><strong>${item.province}</strong></td>
                    <td><span class="kv-badge ${regionClass}">${item.region}</span></td>
                    <td>${item.details || '<em class="text-muted">Không có thông tin chi tiết</em>'}</td>
                `;

                tableBody.appendChild(row);
            });

            // Thêm sự kiện tìm kiếm
            const searchInput = document.getElementById('regionSearch');
            searchInput.addEventListener('input', function() {
                filterRegionTable(this.value);
            });
        }

        // Hàm tìm kiếm trong bảng
        function filterRegionTable(searchTerm) {
            const tableBody = document.getElementById('regionTableBody');
            const rows = tableBody.getElementsByTagName('tr');

            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                const text = row.textContent.toLowerCase();

                if (text.includes(searchTerm.toLowerCase())) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            }
        }

        // Hàm xuất Excel cho bảng khu vực
        function exportRegionTable() {
            const data = [
                ['Mã', 'Tỉnh thành', 'Khu vực', 'Đơn vị hành chính']
            ];

            regionData.forEach(item => {
                data.push([
                    item.code,
                    item.province,
                    item.region,
                    item.details || 'Không có thông tin chi tiết'
                ]);
            });

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Khu vực ưu tiên');
            XLSX.writeFile(wb, 'khu_vuc_uu_tien.xlsx');
        }

        // Hàm xuất Excel cho bảng chứng chỉ ngoại ngữ
        function exportCertificateTable() {
            const data = [
                ['IELTS Academic', 'KNLNN VN', 'Khung Năng lực Châu Âu', 'VSTEP', 'Aptis ESOL', 'PTE Academic', 'PTE', 'Linguaskill', 'Cambridge Assessment English', 'Cambridge English Tests', 'TOEIC Nghe', 'TOEIC Nói', 'TOEIC Đọc', 'TOEIC Viết', 'TOEFL iBT (*)', 'TOEFL ITP'],
                ['5.0', 'Bậc 3', 'B1', '5.5', 'B1', 'Level 2', '43 - 58', '140 - 159', 'B1 Preliminary/B1 Business Preliminary', 'PET (140 - 159)', '275 - 395', '275 - 380', '120 - 150', '120 - 140', '30 - 45', '450 - 499'],
                ['5.5', '', '6.0 - 6.5', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['6.0', 'Bậc 4', 'B2', '7.0 - 7.5', 'B2', 'Level 3', '59 - 75', '160 - 179', 'B2 First/B2 Business Vantage', 'FCE (160 - 179)', '400 - 485', '385 - 450', '160 - 170', '150 - 170', '46 - 93', ''],
                ['6.5', '', '8.0', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['7.0', '', '8.5', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['7.5', 'Bậc 5', 'C1', '9.0', 'C1', 'Level 4', '76 - 84', '>180', 'C1 Advanced/C1 Business Higher', 'CAE (180 - 199)', '490', '455', '180 - 200', '180 - 200', '94 - 114', ''],
                ['8.0', '', '9.5 - 10', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['8.5', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['9.0', 'Bậc 6', 'C2', '', 'C2', 'Level 5', '85 - 90', '', 'C2 Proficiency', 'CPE (200 - 230)', '', '', '', '', '115 - 120', '']
            ];

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Chứng chỉ ngoại ngữ");

            // Xuất file
            XLSX.writeFile(wb, "bang_quy_doi_chung_chi_ngoai_ngu.xlsx");
        }
    </script>
</body>
</html>
